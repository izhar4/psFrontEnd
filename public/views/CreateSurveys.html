<div ng-controller="surveyCtrl" class="create-survey-wrapper" >
    <header class="dashbboard-header">
        <div class="col-xs-10 col-sm-4 col-md-4 dash-logo-section">
            <img class="img-responsive" src="img/logo-without-name.png" alt="Logo" title="" ui-sref="home" ng-click = "clearFields()"/>
            <p><a href="tel:+877865-PURE">(877) 865-PURE</a></p>
        </div>
        <div class="col-xs-12 col-sm-8 col-md-8 pull-right text-right" ng-if="!manageEdit">
            <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse" id="header_menu">
                    <ul class="nav navbar-nav navbar-right survey-details" >
                        <li ng-if="properties.clickBalance == 1">
                            <h6>clicks</h6>
                            <span>{{properties.estmClicks | number:0}}</span>
                        </li>
                        <li>
                            <h6>completes</h6>
                            <span>{{completes | number:0}}</span>
                        </li>
                        <li>
                            <h6>cpi:</h6>
                            <span>{{cpi | currency: value = currency_symbol}}</span>
                        </li>
                        <li>
                            <h6>total cost:</h6>
                            <span>{{total | currency: value = currency_symbol}}</span>
                        </li>
                        <li>
                            <h6>field time</h6>
                            <span>{{field_time}}</span>
                        </li>
                        <li class="no-border">
                            <button type="button" class="close" ui-sref="home" ng-click = "clearFields()">
                                <span aria-hidden="true" >&times;</span>
                            </button>
                        </li>
                    </ul>
                </div><!-- /.navbar-collapse -->
        </div>
        <div class="col-xs-2 col-sm-2 col-md-2 pull-right text-right"  ng-if="manageEdit">
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="header_menu">
                <ul class="nav navbar-nav navbar-right survey-details"> 
                    <li class="no-border">
                        <button type="button" class="close"  ng-click="closeManage(srvId); clearFields()">
                            <span aria-hidden="true" >&times;</span>
                        </button>
                    </li>
                </ul>
            </div><!-- /.navbar-collapse -->
        </div>
        <div class="clearfix"></div>
    </header>
    <section class="pad">
        <div class="container">
            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-11 survey">
                    <!--<h4>Create your survey</h4>-->
                    <form class="create-survey" name="surveyform" >
                        <div class="survey-form">
                            <div class="form-inline">
                                <div class="col-xs-12 col-sm-8 col-md-8 form-group">
                                    <!-- <label for="SurveyTitle" >{{'tr_survey_title' | translate}}</label> -->
                                    <label for="SurveyTitle" >Survey Title</label>
                                    <input type="text"  class="form-control survey-style width100" name="surveyTitle" id="SurveyTitle"  ng-model="properties.surveyTitle"  required/>
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4 form-group">
                                    <label>Category</label>
                                    <div class="dropdown dropdown-scroll">
                                        <button class="btn btn-default dropdown-toggle survey-style width100" type="button" id="Survey_Sample_Title" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" ng-disabled="manageEdit">
                                            {{samplesValue || 'Select Category'}}
                                        </button>
                                        <ul class="dropdown-menu" style="height: auto; max-height: 200px;    overflow-x: hidden;" aria-labelledby="Survey_Sample_Title">
                                            <li role="presentation">
                                              <div class="input-group input-group-sm search-control"> <span class="input-group-addon">
                                                <span class="glyphicon glyphicon-search"></span>
                                                </span>
                                                <input type="text" class="form-control" placeholder="Search" ng-model="categoryFilter"></input>
                                              </div>
                                            </li>
                                            <li ng-repeat="data in samples | filter:categoryFilter"><a href="" ng-click="setSample(data.id)">{{data.name}}</a></li>
                                        </ul>
                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                                <div class="clearfix"></div>
                            </div>
                            <div class="form-inline mar0">
                                <div class="col-md-5 padlr0">
                                    <div class="col-xs-6 col-sm-6 col-md-6 form-group country-dropdown">
                                        <label>Country</label>
                                        <div class="dropdown dropdown-scroll">
                                            <button class="btn btn-default dropdown-toggle survey-style width100" type="button" id="Survey_Country" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" ng-disabled="manageEdit || surveyStatus != 00">
                                            {{countryValue || 'United States'}}
                                            </button>
                                            <ul class="dropdown-menu" aria-labelledby="Survey_Country">
                                                <li role="presentation">
                                                  <div class="input-group input-group-sm search-control"> <span class="input-group-addon">
                                                    <span class="glyphicon glyphicon-search"></span>
                                                    </span>
                                                    <input type="text" class="form-control" placeholder="Search" ng-model="countryFilter"></input>
                                                  </div>
                                                </li>
                                                <li ng-repeat="data in country | filter:countryFilter"><a href="" ng-click="setCountry($event, data)">{{data.name}}</a></li>
                                            </ul>
                                        </div>
                                        <div class="clearfix"></div>
                                    </div>
                                    <div class="col-xs-6 col-sm-6 col-md-6 form-group">
                                        <label>Language</label>
                                        <div class="dropdown">
                                            <button class="btn btn-default dropdown-toggle survey-style width100" type="button"  id="languagedrop" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" ng-click="" ng-disabled="manageEdit">
                                                {{languageValue || 'English'}}
                                            </button>
                                            <ul class="dropdown-menu" aria-labelledby="languagedrop">
                                                <li ng-repeat="data in lang"><a href="" ng-click="setLanguage(data.id)">{{data.name}} </a></li>
                                            </ul>
                                        </div>                 
                                    </div>
                                </div>
                                <div class="col-md-7 padlr0">
                                    <div class="col-xs-3 col-sm-3 col-md-3 form-group completes-box">
                                        <label for="completes">Completes</label>
                                        <input type="text" max="99999" ng-keypress="tabbing($event, 'languagedrop','LengthofSurvey');" onkeypress='return validateCompletes(event);' class="form-control survey-style width110" id="completes" name="numberOfCompletes"  ng-model="properties.numberOfCompletes" required="" ng-blur="getCompletes(properties.numberOfCompletes);" ng-model-options="{ updateOn: 'default change blur', debounce: {default:200, blur:0, change:0} }" maxlength="5" ng-readonly="clicksGoal">
                                        <span ng-if="totalFielded >= 0">Fielded: {{totalFielded}}</span>  
                                    </div>
                                   
                                    <div class="col-xs-3 col-sm-3 col-md-3 form-group place_holder">
                                        <label>Length of <br> Survey</label> <!-- PD-657 -->
                                        <input type="text" max="99" maxlength="2" onkeypress='return validateCompletes(event);' class="form-control survey-style width100" name="lengthOfSurvey" id="LengthofSurvey"  ng-model="properties.lengthOfSurvey" required=""  ng-blur="getLOS(properties.lengthOfSurvey)" ng-keyup="getLOS(properties.lengthOfSurvey)" ng-keypress="tabbing($event,'completes','incidence');" ng-readonly="manageEdit">
                                        <span>mins</span>
                                  
                                    </div>
                                   
                                    <div class="col-xs-3 col-sm-3 col-md-3 form-group place_holder">
                                       <label>Incidence</label>
                                      <input type="text" id="incidence" ng-keypress="tabbing($event,'LengthofSurvey', '#genderModal');"  maxlength="2" onkeypress='return validateCompletes(event);' class="form-control survey-style width100" name="incidence" ng-model="incidence"  ng-keyup="getINS(incidence)" ng-blur="getINS(incidence)" data-toggle="tooltip" title="incidence is the percent of survey takers that qualify in the survey after meeting all the audience targeting criteria and quotas below" ng-readonly="manageEdit || clicksGoal">
                                       <span>%</span>   
                                    </div>
                                    <div class="col-xs-3 col-sm-3 col-md-3 form-group place_holder">
                                        <label for="field_time">FIELD TIME</label>
                                        <input type="number" id="field_time" name="" class="form-control border-less-input survey-style width100" style="" maxlength="3" ng-model="properties.field_time" onkeypress='return validateCompletes(event, this);' ng-blur="getFieldTime(properties.field_time, properties.creationDate)" ng-keypress="tabbing($event,'completes','gender_qmodel');">
                                        <span>days</span>
                                    </div>
                                </div>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                        <click-balancing to-show="fieldsFlags.clickBal" completes="properties.numberOfCompletes" incidence="incidence" total-clicks="properties.estmClicks" completes-needed="completesNeeded" balancing-switch="properties.clickBalance" quota-update="updateQuotasOnChange()" live-edit="liveSurveyEditingStep"></click-balancing>
                        <div class="survey-form mar145">
                            <div class="form-inline">
                                <div class="col-xs-3 col-sm-3 col-md-3">
                                    <p class="pull-right" ng-show="gndrQuotaFlag.hasGndrFlag && !isNested('gender')">Has Quotas</p>
                                    <p class="pull-right" ng-show="isNested('gender')">Auto Nested</p>
                                    <label>Gender</label>
                                    <div class="dropdown" ng-class = "{ 'na-cursor ':disableQualification}" id="gender_qmodel" ng-keydown="tabbing($event,'field_time','drop_qId');">
                                    <!-- PD-1130 -->
                                     <div  ng-dropdown-multiselect="" options="genderInfo" selected-model="sltGender"  extra-settings="mainSettings" checkboxes="true" number-completes="properties.numberOfCompletes" edit-flag="gndrQuotaFlag.editGndrFlag" open-modal="genderModal" ng-click="completesBeforeQuota();quotaNumberChange('id', genderInfo, gndrQuotaFlag.gndrFlxValue, 'gndr')" gender-quota="gndrQuotaFlag.hasGndrFlag" ng-class = "{ 'inactive ':disableQualification}" censusrepoapply ="applyCensusRepo(nameArgs)" census-gender="censusRepoFlag.hasCensusRepoGndr" disable-census="fieldsFlags.census" category-name="gender" > </div></div>
                                      
                                </div>
                                <div class="col-xs-3 col-sm-3 col-md-3">
                                    <p class="pull-right" ng-show="ageQuotaFlag.hasAgeFlag && !isNested('age')">Has Quotas</p>
                                    <p class="pull-right" ng-show="isNested('age')">Auto Nested</p>
                                    <label>Age</label>
                                    <div class="dropdown" ng-class = "{ 'na-cursor ':disableQualification}" id="age_qmodel" ng-keydown="tabbing($event,'drop_qId','age_qbmodel');">
                                        <button class="btn btn-default dropdown-toggle survey-style width100"  type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" ng-click="completesBeforeQuota()" ng-class = "{ 'inactive ':disableQualification}">
                                          <span ng-hide="ageTlt==false">All</span> <span ng-show="ageShow==true"> {{ageData.min}} - {{ageData.max}}</span> 
                                        </button>
                                        <ul class="dropdown-menu"  aria-labelledby="Survey_Country">
                                             <button type="button" class="btn btn-primary btn-link btn-xs pull-left" data-toggle="modal" data-target="#ageModal" ng-click="openAgeModal()" id="age_qbmodel" ng-keydown="tabbing($event,'age_qmodel','income_qmodel');"><span ng-show="!ageQuotaFlag.editAgeFlag">Add Quotas</span> <span ng-show="ageQuotaFlag.editAgeFlag">Edit Quota</span>
                                             </button>
                                             <!-- PD-1130 -->

                                             <button type="button" class="btn btn-primary btn-link btn-xs pull-left" ng-if="fieldsFlags.census" ng-click="applyCensusRepo('age')" ng-disabled="censusRepoFlag.hasCensusRepoAge"><span>Census</span>
                                             </button>

                                             <button type="button" class="btn btn-primary btn-link btn-xs pull-right" data-toggle="modal" data-target="#myModal">  
                                             <span ng-show="ageQuotaFlag.clearAgeFlag">Delete Quotas</span>
                                             </button>


                                            <li>
                                                <div class="input-group">
                                                    <input  type="text" ng-click="ageSltBoxTlt()" ng-keypress="ageSltBoxVal()" ng-blur="checkAgeMin()" min="13" max="99" onkeypress="return validateCompletes(event)"  class="form-control  survey-style width110" name="age" placeholder="13" maxlength="2" ng-model="ageData.min" ng-init="ageData.min = ''" />
                                                    <span class="input-group-addon">to</span>

                                                    <input type="text" min="13" max="99" ng-click="ageSltBoxTlt()" ng-keypress="ageSltBoxVal()" 
                                                    ng-blur="checkAgeMax()" onkeypress='return validateCompletes(event);'  class="form-control  survey-style width110" placeholder="99" maxlength="2" ng-required="angular.isDefined(ageData.min)" ng-model="ageData.max" ng-init="ageData.max = ''" />
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-xs-3 col-sm-3 col-md-3 form-group" ng-show="fieldsFlags.hhi">
                                    <p class="pull-right" ng-show="incomeQuotaFlag.hasIncomeFlag && !isNested('houseHoldIncome')">Has Quotas</p>
                                    <p class="pull-right" ng-show="isNested('houseHoldIncome')">Auto Nested</p>
                                    <label>Income</label>
                                    <div class="dropdown width100" ng-class = "{ 'na-cursor ':disableQualification}" id="income_qmodel" ng-keydown="tabbing($event,'age_qbmodel','income_qbmodel');">
                                        <button class="btn btn-default dropdown-toggle survey-style width100" type="button"  data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" ng-click="completesBeforeQuota()" ng-class = "{ 'inactive ':disableQualification}">
                                          <span ng-hide="incmTlt==false">All</span> <span ng-show="incmShow==true">{{houseHoldIncome.units | rangeCharUnit}}{{houseHoldIncome.min}} - {{houseHoldIncome.units | rangeCharUnit}}{{houseHoldIncome.max}} </span> <!-- <span class="caret"></span> -->
                                        </button>
                                        <ul class="dropdown-menu" aria-labelledby="Survey_Country">
                                           <button type="button" id="income_qbmodel" class="btn btn-primary btn-link btn-xs pull-left" data-toggle="modal" data-target="#incomeModal" ng-click="openIncomeModal()"> <span ng-show="!incomeQuotaFlag.editIncomeFlag">Add Quotas</span> <span ng-show="incomeQuotaFlag.editIncomeFlag">Edit Quota</span></button>
                                           <!-- PD-1130 -->

                                           <button type="button" class="btn btn-primary btn-link btn-xs pull-left" ng-if="fieldsFlags.census" ng-disabled="censusRepoFlag.hasCensusRepoIncome" ng-click="applyCensusRepo('income')"> <span>Census</span></button>

                                           <button type="button" class="btn btn-primary btn-link btn-xs pull-right" data-toggle="modal" data-target="#myModalincome" >  
                                           <span ng-show="incomeQuotaFlag.clearIncomeFlag">Delete Quotas</span>
                                           </button>


                                            <li>
                                                <div class="input-group">
                                                     <input type="text" ng-keypress="incomeSltBoxVal()" ng-click="incomeSltBoxTlt()" ng-blur="checkIncomeMin()" onkeypress='return validateCompletes(event);'  class="form-control  survey-style width110" name="income" placeholder="0" ng-model="houseHoldIncome.min" ng-init="houseHoldIncome.min = ''" />
                                                     <span class="input-group-addon">to</span>
                                                     <input type="text" maxlength="{{incomeInputBoxVal.maxlength}}" ng-keypress="incomeSltBoxVal()" ng-click="incomeSltBoxTlt()" ng-blur="checkIncomeMax()" onkeypress='return validateCompletes(event);'   class="form-control  survey-style width110"  placeholder="{{incomeInputBoxVal.placeholder}}" ng-model="houseHoldIncome.max" ng-init="houseHoldIncome.max = ''" />
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-xs-3 col-sm-3 col-md-3" ng-if="fieldsFlags.race">
                                    <p class="pull-right" ng-show="raceQuotaFlag.hasRaceFlag && !isNested('race')">Has Quotas</p>
                                    <p class="pull-right" ng-show="isNested('race')">Auto Nested</p>
                                    <label>Race </label>
                                    <div class="dropdown" ng-class = "{ 'na-cursor ':disableQualification}">
                                    <!-- PD-961 -->
                                        <div ng-hide="isGrouped('race')" ng-dropdown-multiselect=""  options="race"  selected-model="sltRace"  checkboxes="true"  extra-settings="mainSettings" number-completes="properties.numberOfCompletes"  open-modal="raceModal" edit-flag="raceQuotaFlag.editRaceFlag" ng-click="completesBeforeQuota();quotaNumberChange('data' , race, raceQuotaFlag.raceFlxValue, 'raceSw')" race-quota="raceQuotaFlag.hasRaceFlag" ng-class = "{ 'inactive ':disableQualification}" censusrepoapply ="applyCensusRepo(nameArgs)" census-race="censusRepoFlag.hasCensusRepoRace" disable-census="fieldsFlags.census"></div>
                                        <!-- PD-1130 -->
                                        <div ng-show="isGrouped('race')" ng-dropdown-multiselect=""  options="race"  selected-model="sltRace"  checkboxes="true"  extra-settings="mainSettings" number-completes="properties.numberOfCompletes"  open-modal="raceModal" edit-flag="raceQuotaFlag.editRaceFlag" ng-click="completesBeforeQuota();quotaNumberChange('data' , newraceModal, raceQuotaFlag.raceFlxValue, 'raceSw')" race-quota="raceQuotaFlag.hasRaceFlag" ng-class = "{ 'inactive ':disableQualification}" censusrepoapply ="applyCensusRepo(nameArgs)" census-race="censusRepoFlag.hasCensusRepoRace" disable-census="fieldsFlags.census" delete-race="isGrouped('race')" remove-grouping="conditionGroupingArray"></div>
                                    </div>
                                </div>
                                <div class="col-xs-3 col-sm-3 col-md-3" ng-if="fieldsFlags.bera">
                                    <p class="pull-right" ng-show="rbQuotaFlag.hasRbFlag">Has Quotas</p>
                                    <label>Race Bera</label>
                                    <div class="dropdown" ng-class = "{ 'na-cursor ':disableQualification}">
                                    <!-- PD-1402 -->
                                        <div ng-hide="isGrouped('raceBera')"  ng-dropdown-multiselect="" options="raceBera" selected-model="sltRaceBera"  extra-settings="mainSettings" checkboxes="true" number-completes="properties.numberOfCompletes" open-modal="rbModal" rb-quota="rbQuotaFlag.hasRbFlag" ng-click="completesBeforeQuota(); quotaNumberChange('data', raceBera, rbQuotaFlag.rbFlxValue, 'rbSw');" edit-flag="rbQuotaFlag.editRbFlag"> </div>

                                        <div ng-show="isGrouped('raceBera')"  ng-dropdown-multiselect="" options="raceBera" selected-model="sltRaceBera"  extra-settings="mainSettings" checkboxes="true" number-completes="properties.numberOfCompletes" open-modal="rbModal" rb-quota="rbQuotaFlag.hasRbFlag" ng-click="completesBeforeQuota(); quotaNumberChange('data', groupingRaceBeraModel, rbQuotaFlag.rbFlxValue, 'rbSw');" edit-flag="rbQuotaFlag.editRbFlag" delete-racebera="isGrouped('raceBera')" remove-grouping="conditionGroupingArray"> </div>
                                    </div>
                                </div>
                                <div class="col-xs-3 col-sm-3 col-md-3" ng-if="fieldsFlags.bera">
                                    <p class="pull-right" ng-show="hisQuotaFlag.hasHisOriFlag">Has Quotas</p>
                                    <label>Hispanic Origin</label>
                                    <div class="dropdown" ng-class = "{ 'na-cursor ':disableQualification}">
                                    <!-- PD-1130 -->
                                        <div  ng-dropdown-multiselect="" options="hispanic" selected-model="hispanicOrigin"  extra-settings="mainSettings" checkboxes="true" number-completes="properties.numberOfCompletes" open-modal="hispanicModal" hispanic-quota="hisQuotaFlag.hasHisOriFlag" ng-click="completesBeforeQuota();quotaNumberChange('data', hispanic, hisQuotaFlag.hispanicFlxValue, 'hispanicSw');" edit-flag="hisQuotaFlag.editHisOriFlag" censusrepoapply ="applyCensusRepo(nameArgs)" census-hispanic="censusRepoFlag.hasCensusRepoHis" disable-census="fieldsFlags.census"> </div></div>
                                </div>
                                <div class="col-xs-3 col-sm-3 col-md-3" ng-if="fieldsFlags.relationship">
                                    <p class="pull-right" ng-show="rlnQuotaFlag.hasRlnFlag && !isNested('relationships')">Has Quotas</p>
                                    <p class="pull-right" ng-show="isNested('relationships')">Auto Nested</p>
                                    <label >Relationship</label>
                                    <div class="dropdown" ng-class = "{ 'na-cursor ':disableQualification}">
                                    <!-- PD-961 -->
                                        <div ng-hide="isGrouped('relationships')" ng-dropdown-multiselect="" options="relation" selected-model="sltRelation" checkboxes="true" extra-settings="mainSettings"  number-completes="properties.numberOfCompletes"  open-modal="rlnModal" edit-flag="rlnQuotaFlag.editRlnFlag" ng-click="completesBeforeQuota();quotaNumberChange('data', relation, rlnQuotaFlag.rlnFlxValue, 'rlnSw');" relation-quota="rlnQuotaFlag.hasRlnFlag" ng-class = "{ 'inactive ':disableQualification}"></div>

                                        <div ng-show="isGrouped('relationships')" ng-dropdown-multiselect="" options="relation" selected-model="sltRelation" checkboxes="true" extra-settings="mainSettings"  number-completes="properties.numberOfCompletes"  open-modal="rlnModal" edit-flag="rlnQuotaFlag.editRlnFlag" ng-click="completesBeforeQuota();quotaNumberChange('data', newrelationModal, rlnQuotaFlag.rlnFlxValue, 'rlnSw');" relation-quota="rlnQuotaFlag.hasRlnFlag" ng-class = "{ 'inactive ':disableQualification}" delete-relation="isGrouped('relationships')" remove-grouping="conditionGroupingArray"></div>
                                    </div>
                                </div>
                                <div class="col-xs-3 col-sm-3 col-md-3" ng-if="fieldsFlags.children">
                                    <p class="pull-right" ng-show="childQuotaFlag.hasChldFlag && !isNested('children')">Has Quotas</p>
                                    <p class="pull-right" ng-show="isNested('children')">Auto Nested</p>
                                    <label >Children </label>
                                    <div class="dropdown na-cursor">
                                    <div ng-dropdown-multiselect=""  options="children" selected-model="sltChildren" checkboxes="true" extra-settings="mainSettings" number-completes="properties.numberOfCompletes"  open-modal="chldModal" edit-flag="childQuotaFlag.editChldFlag" ng-click="openChldModal();completesBeforeQuota()" children-quota="childQuotaFlag.hasChldFlag" child-quota-data="chldTempArr" ng-class="{'inactive' : disableQualification}" category-name="children" child-data-clear="childSltBoxVal()"></div></div>
                                </div>
                                <div class="col-xs-3 col-sm-3 col-md-3 " ng-if="fieldsFlags.employment">
                                    <p class="pull-right" ng-show="empQuotaFlag.hasEmpFlag && !isNested('employments')">Has Quotas</p>
                                    <p class="pull-right" ng-show="isNested('employments')">Auto Nested</p>
                                    <label >Employment </label>
                                    <div class="dropdown" ng-class = "{ 'na-cursor ':disableQualification}">
                                    <!-- PD-961 -->
                                        <div ng-hide="isGrouped('employments')" ng-dropdown-multiselect="" options="employement" selected-model="sltEmployment" checkboxes="true" extra-settings="mainSettings" number-completes="properties.numberOfCompletes"  open-modal="empModal" edit-flag="empQuotaFlag.editEmpFlag" ng-click="completesBeforeQuota();quotaNumberChange('data', employement, empQuotaFlag.empFlxValue, 'empSw')" employment-quota="empQuotaFlag.hasEmpFlag" ng-class = "{ 'inactive ':disableQualification}" censusrepoapply ="applyCensusRepo(nameArgs)" census-employment="censusRepoFlag.hasCensusRepoEmploy" disable-census="fieldsFlags.census"></div>

                                        <div ng-show="isGrouped('employments')" ng-dropdown-multiselect="" options="employement" selected-model="sltEmployment" checkboxes="true" extra-settings="mainSettings" number-completes="properties.numberOfCompletes"  open-modal="empModal" edit-flag="empQuotaFlag.editEmpFlag" ng-click="completesBeforeQuota();quotaNumberChange('data', groupingemploymentModal, empQuotaFlag.empFlxValue, 'empSw')" employment-quota="empQuotaFlag.hasEmpFlag" ng-class = "{ 'inactive ':disableQualification}" censusrepoapply ="applyCensusRepo(nameArgs)" census-employment="censusRepoFlag.hasCensusRepoEmploy" disable-census="fieldsFlags.census" delete-employment="isGrouped('employments')" remove-grouping="conditionGroupingArray"></div>
                                    </div>
                                </div>
                                <div class="col-xs-3 col-sm-3 col-md-3 " ng-if="fieldsFlags.education">
                                    <p class="pull-right" ng-show="eduQuotaFlag.hasEduFlag && !isNested('educations')">Has Quotas</p>
                                    <p class="pull-right" ng-show="isNested('educations')">Auto Nested</p>
                                    <label>Education </label>
                                    <div class="dropdown" ng-class = "{ 'na-cursor ':disableQualification}">
                                    <!-- PD-1130 -->
                                    <!-- PD-961 -->
                                        <div ng-hide="isGrouped('educations')" ng-dropdown-multiselect="" options="education" selected-model="sltEducation" checkboxes="true" extra-settings="mainSettings" number-completes="properties.numberOfCompletes"  open-modal="eduModal" edit-flag="eduQuotaFlag.editEduFlag" ng-click="completesBeforeQuota();quotaNumberChange('data', education, eduQuotaFlag.eduFlxValue, 'eduSw')" education-quota="eduQuotaFlag.hasEduFlag" ng-class = "{ 'inactive ':disableQualification}" censusrepoapply ="applyCensusRepo(nameArgs)" census-education="censusRepoFlag.hasCensusRepoEdu" disable-census="fieldsFlags.census"></div>

                                        <div ng-show="isGrouped('educations')" ng-dropdown-multiselect="" options="education" selected-model="sltEducation" checkboxes="true" extra-settings="mainSettings" number-completes="properties.numberOfCompletes"  open-modal="eduModal" edit-flag="eduQuotaFlag.editEduFlag" ng-click="completesBeforeQuota();quotaNumberChange('data', groupingeducationModal, eduQuotaFlag.eduFlxValue, 'eduSw')" education-quota="eduQuotaFlag.hasEduFlag" ng-class = "{ 'inactive ':disableQualification}" censusrepoapply ="applyCensusRepo(nameArgs)" census-education="censusRepoFlag.hasCensusRepoEdu" disable-census="fieldsFlags.census" delete-education="isGrouped('educations')" remove-grouping="conditionGroupingArray"></div>
                                    </div>
                                </div>
                                
                                <div class="clearfix"></div>
                            </div>
                        </div>
                        <div class="survey-form mar35">
                            <div class="form-inline">
                                <div class="col-sm-4 col-md-3" ng-if="fieldsFlags.device">
                                  <p class="pull-right" ng-show="dvcQuotaFlag.hasDeviceFlag && !isNested('device')">Has Quotas</p>
                                  <p class="pull-right" ng-show="isNested('device')">Auto Nested</p>
                                    <label >Device </label>
                                    <div class="dropdown" ng-class = "{ 'na-cursor ':disableQualification}">
                                    <!-- PD-1402 -->
                                      <div ng-hide="isGrouped('device')" ng-dropdown-multiselect=""  options="deviceInfo" selected-model="sltDevice" checkboxes="true" extra-settings="mainSettings"  number-completes="properties.numberOfCompletes" open-modal="dvcModal" edit-flag="dvcQuotaFlag.editDvcFlag" ng-click="completesBeforeQuota();quotaNumberChange('data', deviceInfo, dvcQuotaFlag.dvcFlxValue, 'devcSw')" device-quota="dvcQuotaFlag.hasDeviceFlag" ng-class = "{ 'inactive ':disableQualification}"></div>

                                      <div ng-show="isGrouped('device')" ng-dropdown-multiselect=""  options="deviceInfo" selected-model="sltDevice" checkboxes="true" extra-settings="mainSettings"  number-completes="properties.numberOfCompletes" open-modal="dvcModal" edit-flag="dvcQuotaFlag.editDvcFlag" ng-click="completesBeforeQuota();quotaNumberChange('data', groupingDeviceModel, dvcQuotaFlag.dvcFlxValue, 'devcSw')" device-quota="dvcQuotaFlag.hasDeviceFlag" ng-class = "{ 'inactive ':disableQualification}" delete-device="isGrouped('device')" remove-grouping="conditionGroupingArray"></div>
                                    </div>
                                </div>
                                <div class="col-sm-9 col-md-9 form-group adv-tar-sec" ng-if="fieldsFlags.advTarget">
                                    <label>Advanced Targeting <span ng-if="tempAdvArray.length > 0" style="color: #2993c7;font-size:10px;margin-left:10px;text-transform:capitalize;">Applied</span></label>
                                    <div class="row">
                                        <div class="col-sm-4 col-md-4" ng-repeat="item in tempAdvArray track by $index">
                                            <ng-advance-button data="item" selected-options ="selectedOptions" all-options="myOptions" delete-target="deleteAdvTarget"></ng-advance-button>
                                        </div>
                                        <div class="col-sm-4 col-md-4">
                                          <button id="" data-toggle="modal" data-target="#advanceTargetingModal" class="btn btn-default" type="button" ng-click="clearAdvModal()">
                                            + Add Definition
                                          </button>
                                        </div>
                                        <div class="col-sm-4 col-md-4" ng-if="tempAdvArray.length <= 1">
                                          <button id="" data-toggle="modal" data-target="#advanceTargetingModal" class="btn btn-default" type="button" ng-click="clearAdvModal()" disabled>
                                            + Add Definition
                                          </button>
                                        </div>
                                        <div class="col-sm-4 col-md-4" ng-if="tempAdvArray.length == 0">
                                          <button id="" data-toggle="modal" data-target="#advanceTargetingModal" class="btn btn-default" type="button" ng-click="clearAdvModal()" disabled>
                                            + Add Definition
                                          </button>
                                        </div> 
                                    </div>
                                </div>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-12 col-md-12 set-location" ng-show="fieldsFlags.location">
                            <h4>set location</h4>
                            <!-- display none a tag used to trigger clr loc model popup -->
                            <a hre="" id="clrmodel" style="display:none !important" data-toggle="modal" data-target="#clrLocationModal">&nbsp;&nbsp;clr</a>
                            <a hre="" id="clrmodel1" style="display:none !important" data-toggle="modal" data-target="#alreadySetLocationModal">&nbsp;&nbsp;clr</a>

                            <span ng-if="isNested('regions') || isNested('divisions') || isNested('states') || isNested('csa') || isNested('msa') || isNested('dma') || isNested('county')">AutoNested</span>
                            <a href="" id="clrmodel2" ng-click="clearCompleteLocation()">Clear Location</a>
                            <div class="tabs">
                                <ul class="nav nav-tabs"> 
                                  <li id="tab-natrep" role="presentation" ng-show="locationViews.netrep.isVisible"><a href="#tab_NatRep"><span ng-show="locationData.type == 'natrep'"><i class="fa fa-check"></i></span><span>{{locationViews.netrep.name}}</span></a></li>

                                  <li id="tab-region" role="presentation" ng-show="locationViews.region.isVisible"><a href="#tab_CensusRegion"><span ng-show="locationData.type == 'region'"><i class="fa fa-check"></i></span><span>{{locationViews.region.name}}</span></a></li>

                                  <li id="tab-division" role="presentation" ng-show="locationViews.division.isVisible"><a href="#tab_CensusDivision"><span ng-show="locationData.type == 'division'"><i class="fa fa-check"></i></span><span>{{locationViews.division.name}}</span></a></li>

                                  <li id="tab-state" role="presentation" ng-show="locationViews.state.isVisible"><a href="#tab_State"><span ng-show="locationData.type == 'state'"><i class="fa fa-check"></i></span><span>{{locationViews.state.name}}</span></a></li>

                                  <li id="tab-dma" role="presentation" ng-show="locationViews.dma.isVisible"><a href="#tab_DMA" ><span ng-show="locationData.type == 'dma'"><i class="fa fa-check"></i></span><span>{{locationViews.dma.name}}</span></a></li>

                                  <li id="tab-csa" role="presentation" ng-show="locationViews.csa.isVisible"><a href="#tab_CSA" ><span ng-show="locationData.type == 'csa'"><i class="fa fa-check"></i></span><span>{{locationViews.csa.name === "CSA" ? "CBSA" : ""}}</span></a></li>

                                  <li id="tab-msa" role="presentation" ng-show="locationViews.msa.isVisible"><a href="#tab_MSA" ><span ng-show="locationData.type == 'msa'"><i class="fa fa-check"></i></span><span>{{locationViews.msa.name}}</span></a></li>

                                  <li id="tab-county" role="presentation" ng-show="locationViews.county.isVisible"><a href="#tab_County"><span ng-show="locationData.type == 'county'"><i class="fa fa-check"></i></span><span>{{locationViews.county.name}}</span></a></li>

                                  <li id="tab-zip" role="presentation" ng-show="locationViews.zipcode.isVisible"><a href="#tab_Zipcode"><span ng-show="locationData.type == 'zip'"><i class="fa fa-check"></i></span><span>{{locationViews.zipcode.name}}</span></a></li>
                                </ul>
                                <div class="tab-content">
                                    <div id="tab_NatRep" class="tab" ng-show="locationViews.netrep.isVisible">
                                        <h6>Nationally Representative</h6>
                                        <a href="" class="btn btn-default submit-btn" ng-click="setNationalRep()">Apply</a>
                                    </div>
                                    <div id="tab_CensusRegion" class="tab" ng-show="locationViews.region.isVisible">
                                        <h6>{{locationViews.region.name}}</h6>
                                        <!-- <div class="switch">
                                            <span class="selected">include</span>
                                            <input type="checkbox" id="include_exclude_CensusRegion" class="cmn-toggle cmn-toggle-round" ng-model="selectionRegion" ng-disabled="true">
                                            <label for="include_exclude_CensusRegion" class="inactive na-cursor"></label>
                                            <span class="">exclude</span>
                                            <div class="clearfix"></div>
                                        </div> -->
                                        <button ng-if="!regQuotaFlag.editRegionFlag" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#censusRegionModal" ng-click="completesBeforeQuota(); quotaNumberChange('data',region, regQuotaFlag.regionFlxValue,'regionSw')">Add Quotas</button>

                                        <button id="regeditquota" ng-if="regQuotaFlag.editRegionFlag && locationData.type == 'region' && !isGrouped('regions')" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#censusRegionModal" ng-click="completesBeforeQuota(); quotaNumberChange('data',region, regQuotaFlag.regionFlxValue,'regionSw')">Edit Quotas</button>
                                         <!-- PD-1402 -->
                                        <button id="regeditquota" ng-if="regQuotaFlag.editRegionFlag && locationData.type == 'region' && isGrouped('regions')" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#censusRegionModal" ng-click="completesBeforeQuota(); quotaNumberChange('data',groupingCensusRgnModel, regQuotaFlag.regionFlxValue,'regionSw')">Edit Quotas</button>

                                        <button ng-if="regQuotaFlag.editRegionFlag && locationData.type == 'natrep'" type="button" class="btn btn-default btn-link btn-xs" ng-click="editNatRepQuota()">Edit Quotas</button>

                                        <button ng-if="regQuotaFlag.editRegionFlag && locationData.type == 'region'" type="button" data-toggle="modal" data-target="#resionModal" class="btn btn-default btn-link btn-xs">Clear Quotas</button>
                                        <button ng-if="regQuotaFlag.editRegionFlag && locationData.type == 'natrep'" type="button" class="btn btn-default btn-link btn-xs" ng-click="clearNatRepQuota()">Clear Quotas</button>
                                        <div class="census-region">
                                            <div class="checkbox" ng-repeat="reg in region">
                                                <input type="checkbox" ng-model="reg.selected" value="{{ reg.id }}" id="reg_{{ reg.id }}"  ng-click="setSelectRegion(reg.id, reg.selected, $event, region, $index)">
                                              <label for="reg_{{ reg.id }}"><span>{{ reg.name }}</span></label>
                                              <span>{{ reg.cnt }}</span>
                                            </div>
                                            <div class="clearfix"></div>
                                        </div>
                                    </div>
                                    <div id="tab_CensusDivision" class="tab" ng-show="locationViews.division.isVisible">
                                        <h6>{{locationViews.division.name}}</h6>
                                        
                                        <button ng-if="!dvsnQuotaFlag.editDivisionFlag" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#censusDivisionModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', division, dvsnQuotaFlag.divisionFlxValue,'divisionSw')">Add Quotas</button>
                                        <button ng-if="dvsnQuotaFlag.editDivisionFlag && !isGrouped('divisions')" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#censusDivisionModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', division, dvsnQuotaFlag.divisionFlxValue,'divisionSw')">Edit Quotas</button>
                                        <!-- PD-1402 -->
                                        <button ng-if="dvsnQuotaFlag.editDivisionFlag && isGrouped('divisions')" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#censusDivisionModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', groupingDivisionModel, dvsnQuotaFlag.divisionFlxValue,'divisionSw')">Edit Quotas</button>

                                        <button ng-if="dvsnQuotaFlag.editDivisionFlag" type="button" data-toggle="modal" data-target="#divisionModal" class="btn btn-default btn-link btn-xs">Clear Quotas</button>
                                        <div class="census-division">
                                            <div class="select-division">
                                                <div class="checkbox" ng-repeat="div in division">
                                                    <input type="checkbox" ng-model="div.selected" value="{{ div.id }}" id="division_{{ div.id }}" ng-click="setSelectDivision(div.id, div.selected, $event, division, $index)">
                                                    <label for="division_{{ div.id }}"><span>{{ div.name }}</span></label>
                                                    <span>{{ div.cnt }}</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- tab state -->
                                    <div id="tab_State" class="tab" ng-show="locationViews.state.isVisible">
                                        <h6>{{locationViews.state.name}}</h6>
                                        <button ng-if="!editStateFlag" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#stateModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', selectedStates, stateFlexibility.flxValue,'stateSw')" >Add Quotas</button>
                                        <button ng-if="editStateFlag && !isGrouped('states')" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#stateModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', selectedStates, stateFlexibility.flxValue,'stateSw')">Edit Quotas</button>
                                        <!-- PD-1402 -->
                                        <button ng-if="editStateFlag && isGrouped('states')" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#stateModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', groupingStateModel, stateFlexibility.flxValue,'stateSw')">Edit Quotas</button>

                                        <button ng-if="editStateFlag" type="button" data-toggle="modal" data-target="#stateModalResetAlert" class="btn btn-default btn-link btn-xs">Clear Quotas</button>
                                        <div class="form-group">
                                            
                                            <ng-autocomplete id="state" country="{{properties.countryCode}}" items="stateList" prompt="Start typing (min 3 characters)..." title="name" subtitle="id" model="statename.name" on-select="onStateSelected(state)" />

                                        </div>
                                        <div class="survey-state">
                                            <!-- 1st list from left -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="state in selectedStates track by $index" ng-click="addStateActive($index)" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index >=30 && $index < 40">
                                                    {{state.name}}
                                                    <a ng-click="removeLocation('state', $index)">x</a>
                                                </li>
                                            </ul>
                                            <!-- 2nd list from left -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="state in selectedStates track by $index" ng-click="addStateActive($index)" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index >=10 && $index < 20">
                                                    {{state.name}}
                                                    <a ng-click="removeLocation('state', $index)">x</a>
                                                </li>
                                            </ul>
                                            <!-- Center list -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="state in selectedStates track by $index" ng-click="addStateActive($index)" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index < 10">
                                                    {{state.name}}
                                                    <a ng-click="removeLocation('state', $index)">x</a>
                                                </li>
                                            </ul>
                                            <!-- 2nd list from right -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="state in selectedStates track by $index" ng-click="addStateActive($index)" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index >=20 && $index < 30">
                                                    {{state.name}}
                                                    <a ng-click="removeLocation('state', $index)">x</a>
                                                </li>
                                            </ul>
                                            <!-- 1st list from right -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="state in selectedStates track by $index" ng-click="addStateActive($index)" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index >=40">
                                                    {{state.name}}
                                                    <a ng-click="removeLocation('state', $index)">x</a>
                                                </li>
                                            </ul>
                                            <div class="clearfix"></div>
                                        </div>
                                    </div>
                                    <!-- DMA tab -->
                                    <div id="tab_DMA" class="tab" ng-show="locationViews.dma.isVisible">
                                        <h6>{{locationViews.dma.name}}</h6>
                                        
                                        <button ng-if="!editDMAFlag" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#dmaQuotaModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', selectedDMAs, dmaFlexibility.flxValue,'dmaSw')" >Add Quotas</button>
                                        <button ng-if="editDMAFlag && !isGrouped('dma')" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#dmaQuotaModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', selectedDMAs, dmaFlexibility.flxValue,'dmaSw')">Edit Quotas</button>
                                        <!-- PD-1402 -->
                                        <button ng-if="editDMAFlag && isGrouped('dma')" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#dmaQuotaModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', groupingDmaModel, dmaFlexibility.flxValue,'dmaSw')">Edit Quotas</button>

                                        <button ng-if="editDMAFlag" type="button" data-toggle="modal" data-target="#dmaModalResetAlert" class="btn btn-default btn-link btn-xs">Clear Quotas</button>
                                        
                                        <div class="form-group">
                                            <!-- <input type="text" class="form-control" id="Survey_Tab_CSA" placeholder="Start typing..."> -->
                                            <ng-autocomplete id="dma" items="dmaList" country="{{properties.countryCode}}" prompt="Start typing (min 3 characters)..." title="name" subtitle="id" model="selectedDMAName" on-select="onDMASelected(state)" />
                                        </div>
                                        <div class="survey-state">
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="dma in selectedDMAs track by $index" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index >=30 && $index < 40">
                                                    {{dma.name}}
                                                    <a ng-click="removeLocation('dma', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <!-- 2nd list from left -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="dma in selectedDMAs track by $index" ng-class="{'active' : activeToggleState[$index]}"  ng-if="$index >=10 && $index < 20">
                                                    {{dma.name}}
                                                    <a ng-click="removeLocation('dma', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <!-- Center list -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="dma in selectedDMAs track by $index" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index < 10">
                                                    {{dma.name}}
                                                    <a ng-click="removeLocation('dma', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <!-- 2nd list from right -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="dma in selectedDMAs track by $index" ng-class="{'active' : activeToggleState[$index]}" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index >=20 && $index < 30">
                                                    {{dma.name}}
                                                    <a ng-click="removeLocation('dma', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <!-- 1st list from right -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="dma in selectedDMAs track by $index" ng-class="{'active' : activeToggleState[$index]}" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index >=40 && $index < 50">
                                                    {{dma.name}}
                                                    <a ng-click="removeLocation('dma', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <div class="clearfix"></div>
                                        </div>
                                    </div>
                                    <!-- CSA tab -->
                                    <div id="tab_CSA" class="tab" ng-show="locationViews.csa.isVisible">
                                        <h6>{{locationViews.csa.name === "CSA" ? "CBSA" : ""}}</h6>
                                        
                                        <button ng-if="!editCSAFlag" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#csaQuotaModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', selectedCSAs, csaFlexibility.flxValue,'csaSw')" >Add Quotas</button>
                                        <button ng-if="editCSAFlag && !isGrouped('csa')" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#csaQuotaModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', selectedCSAs, csaFlexibility.flxValue,'csaSw')">Edit Quotas</button>
                                        <!-- PD-1402 -->
                                        <button ng-if="editCSAFlag && isGrouped('csa')" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#csaQuotaModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', groupingCsaModel, csaFlexibility.flxValue,'csaSw')">Edit Quotas</button>

                                        <button ng-if="editCSAFlag" type="button" data-toggle="modal" data-target="#csaModalResetAlert" class="btn btn-default btn-link btn-xs">Clear Quotas</button>
                                        <div class="form-group">
                                            <!-- <input type="text" class="form-control" id="Survey_Tab_CSA" placeholder="Start typing..."> -->
                                            <ng-autocomplete id="csa" country="{{properties.countryCode}}" items="csaList" prompt="Start typing (min 3 characters)..." title="name" subtitle="id" model="selectedCSAName" on-select="onCSASelected(state)" />
                                        </div>
                                        <div class="survey-state">
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="csa in selectedCSAs track by $index" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index >=30 && $index < 40">
                                                    {{csa.name}}
                                                    <a ng-click="removeLocation('csa', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <!-- 2nd list from left -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="csa in selectedCSAs track by $index" ng-class="{'active' : activeToggleState[$index]}"  ng-if="$index >=10 && $index < 20">
                                                    {{csa.name}}
                                                    <a ng-click="removeLocation('csa', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <!-- Center list -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="csa in selectedCSAs track by $index" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index < 10">
                                                    {{csa.name}}
                                                    <a ng-click="removeLocation('csa', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <!-- 2nd list from right -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="csa in selectedCSAs track by $index" ng-class="{'active' : activeToggleState[$index]}" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index >=20 && $index < 30">
                                                    {{csa.name}}
                                                    <a ng-click="removeLocation('csa', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <!-- 1st list from right -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="csa in selectedCSAs track by $index" ng-class="{'active' : activeToggleState[$index]}" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index >=40 && $index < 50">
                                                    {{csa.name}}
                                                    <a ng-click="removeLocation('csa', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <div class="clearfix"></div>
                                        </div>
                                    </div>
                                    <!-- MSA tab -->
                                    <div id="tab_MSA" class="tab" ng-show="locationViews.msa.isVisible">
                                        <h6>{{locationViews.msa.name}}</h6>
                                        <button ng-if="!editMSAFlag" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#msaQuotaModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', selectedMSAs, msaFlexibility.flxValue,'msaSw')" >Add Quotas</button>
                                        <button ng-if="editMSAFlag && !isGrouped('msa')" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#msaQuotaModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', selectedMSAs, msaFlexibility.flxValue,'msaSw')">Edit Quotas</button>
                                        <!-- PD-1402 -->
                                        <button ng-if="editMSAFlag && isGrouped('msa')" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#msaQuotaModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', groupingMsaModel, msaFlexibility.flxValue,'msaSw')">Edit Quotas</button>

                                        <button ng-if="editMSAFlag" type="button" data-toggle="modal" data-target="#msaModalResetAlert" class="btn btn-default btn-link btn-xs">Clear Quotas</button>
                                        
                                        <div class="form-group">
                                            <!-- <input type="text" class="form-control" id="Survey_Tab_MSA" placeholder="Start typing..."> -->
                                            <ng-autocomplete id="msa" country="{{properties.countryCode}}" items="msaList" prompt="Start typing (min 3 characters)..." title="name" subtitle="id" model="selectedMSAName" on-select="onMSASelected(state)" />
                                        </div>
                                        <div class="survey-state">
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="msa in selectedMSAs track by $index" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index >=30 && $index < 40">
                                                    {{msa.name}}
                                                    <a ng-click="removeLocation('msa', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <!-- 2nd list from left -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="msa in selectedMSAs track by $index" ng-class="{'active' : activeToggleState[$index]}"  ng-if="$index >=10 && $index < 20">
                                                    {{msa.name}}
                                                    <a ng-click="removeLocation('msa', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <!-- Center list -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="msa in selectedMSAs track by $index" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index < 10">
                                                    {{msa.name}}
                                                    <a ng-click="removeLocation('msa', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <!-- 2nd list from right -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="msa in selectedMSAs track by $index" ng-class="{'active' : activeToggleState[$index]}" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index >=20 && $index < 30">
                                                    {{msa.name}}
                                                    <a ng-click="removeLocation('msa', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <!-- 1st list from right -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="msa in selectedMSAs track by $index" ng-class="{'active' : activeToggleState[$index]}" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index >=40 && $index < 50">
                                                    {{msa.name}}
                                                    <a ng-click="removeLocation('msa', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <div class="clearfix"></div>
                                        </div>
                                    </div>
                                    <!-- county tab -->
                                    <div id="tab_County" class="tab" ng-show="locationViews.county.isVisible">
                                        <h6>{{locationViews.county.name}}</h6>
                                        
                                        <button ng-if="!editCountyFlag" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#countyQuotaModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', selectedCountys, countyFlexibility.flxValue,'countySw')" >Add Quotas</button>
                                        <button ng-if="editCountyFlag && !isGrouped('county')" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#countyQuotaModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', selectedCountys, countyFlexibility.flxValue,'countySw')">Edit Quotas</button>
                                        <!-- PD-1402 -->
                                        <button ng-if="editCountyFlag && isGrouped('county')" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#countyQuotaModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', groupingCountyModel, countyFlexibility.flxValue,'countySw')">Edit Quotas</button>
                                        <button ng-if="editCountyFlag" type="button" data-toggle="modal" data-target="#countyModalResetAlert" class="btn btn-default btn-link btn-xs">Clear Quotas</button>
                                        <div class="form-group">
                                            <!-- <input type="text" class="form-control" id="Survey_Tab_County" placeholder="Start typing..."> -->
                                            <ng-autocomplete id="county" country="{{properties.countryCode}}"  items="countyList" prompt="Start typing (min 3 characters)..." title="name" subtitle="id" model="selectedCountyName" on-select="onCountySelected(state)" />
                                        </div>
                                        <div class="survey-state">
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="county in selectedCountys track by $index" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index >=30 && $index < 40">
                                                    {{county.name}}
                                                    <a ng-click="removeLocation('county', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <!-- 2nd list from left -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="county in selectedCountys track by $index" ng-class="{'active' : activeToggleState[$index]}"  ng-if="$index >=10 && $index < 20">
                                                    {{county.name}}
                                                    <a ng-click="removeLocation('county', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <!-- Center list -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="county in selectedCountys track by $index" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index < 10">
                                                    {{county.name}}
                                                    <a ng-click="removeLocation('county', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <!-- 2nd list from right -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="county in selectedCountys track by $index" ng-class="{'active' : activeToggleState[$index]}" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index >=20 && $index < 30">
                                                    {{county.name}}
                                                    <a ng-click="removeLocation('county', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <!-- 1st list from right -->
                                            <ul class="list-inline list-unstyled">
                                                <li ng-repeat="county in selectedCountys track by $index" ng-class="{'active' : activeToggleState[$index]}" ng-class="{'active' : activeToggleState[$index]}" ng-if="$index >=40 && $index < 50">
                                                    {{county.name}}
                                                    <a ng-click="removeLocation('county', $index)">x</a>
                                                </li>                           
                                            </ul>
                                            <div class="clearfix"></div>
                                        </div>
                                    </div>
                                    <div id="tab_Zipcode" class="tab" ng-show="locationViews.zipcode.isVisible">
                                        <h6>{{locationViews.zipcode.name}}</h6>
                                        <!-- <div class="switch">
                                            <span class="selected">include</span>
                                            <input type="checkbox" id="include_exclude_Zipcode" class="cmn-toggle cmn-toggle-round" ng-model="selectionZipcode">
                                            <label for="include_exclude_Zipcode" class="inactive na-cursor"></label>
                                            <span class="">exclude</span>
                                            <div class="clearfix"></div>
                                        </div> -->
                                        <button ng-if="!zipcodeQuotaFlg.editZipcodeFlag && zipcodeQuotaFlg.addZipQuotaFlg" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#zipcodeQuotaModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', selectedZipcodes, zipcodeFlexibility.flxValue,'zipcodeSw')" >Add Quotas</button>
                                        <button ng-if="zipcodeQuotaFlg.editZipcodeFlag" type="button" class="btn btn-default btn-link btn-xs" data-toggle="modal" data-target="#zipcodeQuotaModal" ng-click="completesBeforeQuota(); quotaNumberChange('data', selectedZipcodes, zipcodeFlexibility.flxValue,'zipcodeSw')">Edit Quotas</button>
                                        <button ng-if="zipcodeQuotaFlg.editZipcodeFlag" type="button" data-toggle="modal" data-target="#zipcodeModalResetAlert" class="btn btn-default btn-link btn-xs">Clear Quotas</button>
                                        <div class="upload-csv" ng-if="!zipcodeQuotaFlg.editZipcodeFlag">
                                            <a href="" ngf-select="uploadZipcodes($file, $event,this)" accept=".xlsx,.xls,.csv">Upload a file</a>
                                            <span>.csv</span>
                                            <div class="download-csv">
                                                <a href="/zipcode_template.csv">Download Template</a>
                                                <a href="javascript:void(0)">?</a>
                                                <!-- <div class="template">
                                                    <h6>Why use our template?</h6>
                                                    <p>We've designed a template where you can upload your CSAs in bulk and then some more copy filler.</p>
                                                </div>
                                                <div class="triangle"></div> -->
                                            </div>
                                            <a href="" data-toggle="modal" data-target="#viewZipcodes" ng-click="viewLatestZipcodes()">View latest upload</a>
                                            <h6>or</h6>
                                            <a href="" ng-click="clearZipcodes()">Clear zipcodes</a>
                                        </div>                                      
                                         <!-- <div class="form-group">
                                            <textarea class="form-control" rows="8" id="SurveyTabZipcode" placeholder="Paste zipcodes here..." ng-model="zipCodes" ng-blur="getZipCodesTextarea()"></textarea>
                                            <p ng-class="{'has-error': !isValidZipcodes}">{{zipCodesStatusMsg}}</p>
                                        </div> -->
                                    </div>
                                </div>
                            </div>
                            <!-- <button type="submit" class="btn btn-default submit-btn pull-right" ng-click="saveSurvey()" ng-disabled = "surveyform.$invalid" >Save</button>
                            <button type="button" class="btn btn-primary submit-btn pull-left" ui-sref="home">Back to Dashboard</button><br><br> -->
                            <div class="clearfix"></div>
                            </div>

                            <div class="col-xs-12 col-sm-12 col-md-12 nested-quotas">
                                <div>
                                    <button data-target="#nestingModal" data-toggle="modal" class="btn btn-primary btn-link btn-xs pull-left" type="button">Quota Nesting</button><span ng-if="nestedQuota.has == true && nestingQuotasArr.length > 0">&nbsp;&nbsp;&nbsp;&nbsp;(Has Nesting)</span>
                                </div>
                            </div>
                             <div class="col-xs-12 col-sm-12 col-md-12" ng-if="nestedQuotasUiObj.length > completesNeeded">
                                <div class="red-warning-box" >
                                    <span>There are more quotas than completes available.  Some nested quotas have 0 quantity available.  This may cause unexpected behavior - please revise nested quotas if this warning is unexpected.</span>
                                </div>
                            </div>
                    </form>
                </div>
            </div>
        </div>
    </section>   

    <!--footer-->
    <footer>
        <div class="container-fluid">
            <div class="form-next" ng-if="!manageEdit">
                <!-- <button type="submit" class="btn btn-default submit-btn">next step</button> -->
                <div class="col-xs-6 col-sm-3 col-md-3 form-inline">
                    <div class="form-group pull-left">
                        <div class="dropdown">
                          <button class="btn btn-default dropdown-toggle survey-style" type="button" id="More_Actions" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                            Save...  <!-- PD-773 -->
                          </button>
                          <ul class="dropdown-menu" aria-labelledby="More_Actions">
                            <li><a href="" ng-click="saveSurvey('save')" >Save</a></li>
                            <!--<li><a href="">Save and Clone</a></li>
                            <li><a href="">Save and Create New</a></li>-->
                            <li><a href="" ng-click="saveSurvey('saveAndClone')">Save and Clone</a></li>
                            <li><a href="" ng-click="saveSurvey('saveAndNew');clearDataFunc()" >Save and Create New</a></li>
                          </ul>
                        </div>
                    </div>
                </div>
                <!-- PD-658 this div write below progress bar -->
                <!-- <div class="col-xs-6 col-sm-3 col-md-3 text-right pull-right">
                    <button type="" class="btn btn-default submit-btn" ng-click="saveSurvey('moveToNext')" ng-disabled="showLoader == 'DataLoading'">Select Suppliers<span ng-show="showLoader == 'DataLoading'"><i class="glyphicon glyphicon-refresh spinning"></i></span><span ng-hide="showLoader == 'DataLoading'"><i class="fa fa-angle-right"></i></span></button>
                </div> -->
                <div class="col-xs-12 col-sm-6 col-md-6 nesting-steps">
                    <ul class="list-inline">
                        <li class="active">
                            <a href="">Define Audience</a>
                        </li>
                        <li>
                            <a href="" ng-click="goToSuppliers()">Select Suppliers</a>
                        </li>
                        <li>
                            <a href="" >Finalize & Launch!</a>
                        </li>
                    </ul>
                </div>
                <!-- PD-658 -->
                <div class="col-xs-6 col-sm-3 col-md-3 text-right pull-right">
                    <button type="" class="btn btn-default submit-btn" ng-click="saveSurvey('moveToNext')" ng-disabled="showLoader == 'DataLoading'">Select Suppliers<span ng-show="showLoader == 'DataLoading'"><i class="glyphicon glyphicon-refresh spinning"></i></span><span ng-hide="showLoader == 'DataLoading'"><i class="fa fa-angle-right"></i></span></button>
                </div>
            </div>
            <div ng-if="manageEdit" class="pull-right survey-editing-footer">
                <button class="btn btn-default"  ng-click="closeManage(srvId);clearFields()">Cancel</button>
                <button class="btn btn-primary" data-target="#directEditReset" data-toggle="modal">Save Changes</button>
            </div >
        </div>
    </footer>

        <!--race modal-->

        <div class="container-fluid">
        <div id="raceModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click="commonResetModal($event, race, raceQuotaFlag.resetRace, quotaTotalRemRace)">
                                <i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span>
                            </button>
                            <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                                <h2 class="text-center">Quotas for Race:</h2>
                                <p class="text-center" ng-show="isNested('race')">Applying a layered quota will clear this qualification from your auto-nested quotas, causing them to recalculate.  Please verify the auto-nested quotas modal before selecting suppliers.</p>
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                <span><label class="status pull-middle quota-flex-btn"><input type="checkbox" id="raceSw" checked  ng-click ="setRaceFlex($event, race, raceQuotaFlag.raceFlxValue)" ng-model="raceQuotaFlag.raceFlx"><div class="slider round racer"></div></label>&nbsp; &nbsp; by &nbsp; &nbsp; <input type="text" class="text-line disabled-state" maxlength="2"  onkeypress='return validateQty(event);' ng-model="raceQuotaFlag.raceFlxValue" ng-readonly="!properties.numberOfCompletes || !raceQuotaFlag.raceFlx"  ng-keyup="quotaPercentageChange(race, raceQuotaFlag.raceFlxValue); groupingUpdateFleaxibility('race', newraceModal, raceQuotaFlag.raceFlxValue)"  ng-readonly="!properties.numberOfCompletes || !rlnQuotaFlag.rlnFlx" ng-disabled="!raceQuotaFlag.raceFlx"><span>%</span>
                                </span>
                            </div>
                             <!-- PD-961 -->

                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3 text-center" ><br/>
                                <button class="btn btn-primary btn-md grupCondtion submit-btn" type="button" ng-click="raceGrouping.check = !raceGrouping.check" ng-hide="raceGrouping.check">Group Conditions</button>
                                <button class="btn btn-primary btn-sm grupCondtion" type="button" ng-click="selectedQuotaGrouping('race',race); raceGrouping.check = !raceGrouping.check" ng-show="raceGrouping.check">Group</button>
                                <!-- &nbsp; &nbsp; &nbsp; &nbsp; -->
                                <button class="btn btn-primary btn-sm grupCondtion" type="button" ng-click="raceGrouping.check = !raceGrouping.check; removeSelectedQualOnCancel(race,'race')" ng-show="raceGrouping.check">Cancel</button>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <table class="table" id="raceform">
                                            <thead>
                                            <tr>
                                                <th></th>
                                                <th ng-hide="raceGrouping.check">{{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                                <th ng-hide="raceGrouping.check">MIN</th>
                                                <th ng-hide="raceGrouping.check">MAX</th>
                                                <th ng-if="liveSurveyEditingStep == 'editStep1' && !raceGrouping.check">FIELDED</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr ng-repeat="data in race" ng-if="data.selected == true && !isGrouped('race')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': raceGrouping.check == true? raceGrouping.check : raceGrouping.check = false}" ng-click="data.setGrupActive = (raceGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                <td class="td-th-class" >
                                                    <br>
                                                    <label>
                                                    <!-- <input type="checkbox"  class="modalCheckbox" style="margin: 0" ng-change="checkedOption(data.id, data.selected, race, sltRace, raceFlxValue.vlue, data.number,'raceSw')"  ng-model="data.selected"  ng-true-value="true" ng-false-value="false"> -->
                                                        {{data.name}}
                                                   </label>
                                                </td>
                                                <td class="td-th-class" ng-hide="raceGrouping.check">
                                                    <input  type="number" id="num" class=" text-line" onkeypress='return validateCompletes(event);'  ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id ,race, raceQuotaFlag.raceFlxValue, 'raceSw')" ng-keypress="clearNumberChange(race,$index)">&nbsp;&nbsp;&nbsp;
                                                    <input type="text" id="per" class=" text-line"  maxlength="3" onkeypress='return validateCompletes(event);' ng-model="data.per"  ng-keyup="quotaPerChange(data.id ,race, raceQuotaFlag.raceFlxValue, 'raceSw')" ng-readonly="!properties.numberOfCompletes || !data.selected">%
                                                   
                                                </td>
                                                <td class="td-th-class" ng-hide="raceGrouping.check">
                                                    <input type="number" id="min" class="text-line" onkeypress='return validateQty(event);'  ng-model="data.minimum"  ng-readonly="true">
                                                </td>
                                                <td class="td-th-class" ng-hide="raceGrouping.check">
                                                    <input type="number" id="max" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum" ng-readonly="true">
                                                </td>
                                                <td class="td-th-class" ng-if="liveSurveyEditingStep == 'editStep1' && !raceGrouping.check">
                                                    <input type="number" id="achieved" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved" ng-readonly="true">
                                                </td>
                                            </tr>

                                            <!-- With Grouping -->
                                            
                                            <tr ng-repeat="data in newraceModal" ng-if="data.selected == true && isGrouped('race')" 
                                             ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': raceGrouping.check == true? raceGrouping.check : raceGrouping.check = false}" ng-click="data.setGrupActive = (raceGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                <td class="td-th-class" ng-hide="data.condditionGroup && raceGrouping.check" >
                                                    <br>
                                                    <i class="fa fa-chain-broken" aria-hidden="true" ng-click="ungroupedConditionGrouping( 'race', data)" ng-show="data.condditionGroup" style="cursor: pointer; font-size: 20px;"></i>
                                                    <label>
                                                        {{data.name}}
                                                   </label>
                                                </td>
                                                <td class="td-th-class" ng-hide="raceGrouping.check || data.condditionGroup && raceGrouping.check" >
                                                    <input  type="number" id="num" class=" text-line" onkeypress='return validateCompletes(event);'  ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id ,newraceModal, raceFlxValue.vlue, 'raceSw')" ng-keypress="clearNumberChange(newraceModal,$index)" ng-class="{'hoverTr-Text':trhovering}">&nbsp;&nbsp;&nbsp;
                                                    <input type="text" id="per" class=" text-line"  maxlength="3" onkeypress='return validateCompletes(event);' ng-model="data.per"  ng-keyup="quotaPerChange(data.id ,newraceModal, raceFlxValue.vlue, 'raceSw')" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-class="{'hoverTr-Text':trhovering}">%
                                                   
                                                </td>
                                                <td class="td-th-class" ng-hide="raceGrouping.check || data.condditionGroup && raceGrouping.check" >
                                                    <input type="number" id="min" class="text-line" onkeypress='return validateQty(event);'  ng-model="data.minimum"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                </td>
                                                <td class="td-th-class" ng-hide="raceGrouping.check || data.condditionGroup && raceGrouping.check">
                                                    <input type="number" id="max" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum" ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                </td>
                                                <td class="td-th-class" ng-if="liveSurveyEditingStep == 'editStep1' && !raceGrouping.check">
                                                    <input type="number" id="achieved" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved" ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 text-center">
                                <div class="center-block">
                                    <!-- <div class="checkbox">
                                        <input class="checkboxInput" type="checkbox" ng-model="raceGrouping.check" />
                                        <label ng-click = "raceGrouping.check = !raceGrouping.check">Group the remaining conditions as a single quota & allocate the remaining the completes</label>
                                    </div> -->
                                    <p><b>Total Remaining</b></p>
                                    <p><b>
                                            <span ng-if="quotaTotalRemRace == null || quotaTotalRemRace == undefined">
                                                {{completesNeeded | number:0}}
                                            </span>
                                            <span>{{quotaTotalRemRace | number:0}}</span>
                                        </b>
                                    </p>
                                    <span>
                                        <button class="btn btn-primary addQuotas-btn groupedButton" ng-click="addRaceQuota(raceQuotaFlag.raceFlxValue, $event)" data-dismiss="modal">Apply</button>
                                        <button class="btn btn-primary addQuotas-btn" ng-click="addRaceQuota(raceQuotaFlag.raceFlxValue, $event)" ng-disabled="quotaTotalRemRace !=0 || raceAllocationsLessThanFielded" ng-class="{inactiveButton: !raceGrouping.check}" data-dismiss="modal">Apply</button>
                                        <button class="btn btn-primary addQuotas-btn" ng-click="addRaceQuota(raceQuotaFlag.raceFlxValue, $event); addToNesting('race', conditionGroupingArray.race?conditionGroupingArray.race:race, $event);" ng-disabled="quotaTotalRemRace !=0 || raceAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest</button>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--race Bera Modal-->
        <div id="rbModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click="commonResetModal($event, raceBera, rbQuotaFlag.resetRb, quotaTotalRemRace)"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                            <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                                <h2 class="text-center">Quotas for Race Bera:</h2>
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                <span><label class="status pull-middle quota-flex-btn"><input type="checkbox" id="rbSw" checked  ng-click ="setRbFlex($event, raceBera, rbQuotaFlag.rbFlxValue)" ng-model="rbQuotaFlag.raceBeraFlx"><div class="slider round racer"></div></label>&nbsp; &nbsp; by &nbsp; &nbsp; <input type="text" class="text-line disabled-state" maxlength="2"  onkeypress='return validateQty(event);' ng-model="rbQuotaFlag.rbFlxValue" ng-readonly="!properties.numberOfCompletes || !rbQuotaFlag.raceBeraFlx"  ng-keyup="quotaPercentageChange(raceBera, rbQuotaFlag.rbFlxValue); groupingUpdateFleaxibility('raceBera', groupingRaceBeraModel, rbQuotaFlag.rbFlxValue)"  ng-readonly="!properties.numberOfCompletes || !rbQuotaFlag.raceBeraFlx" ng-disabled="!rbQuotaFlag.raceBeraFlx"><span>%</span>
                                </span>
                            </div>

                            <!-- PD-1402 -->

                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3 text-center" ><br/>
                                <button class="btn btn-primary btn-md grupCondtion submit-btn" type="button" ng-click="raceBeraGrouping.check = !raceBeraGrouping.check" ng-hide="raceBeraGrouping.check">Group Conditions</button>
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="selectedQuotaGrouping('raceBera',raceBera); raceBeraGrouping.check = !raceBeraGrouping.check" ng-show="raceBeraGrouping.check">Group</button>
                                <!-- &nbsp; &nbsp; &nbsp; &nbsp; -->
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="raceBeraGrouping.check = !raceBeraGrouping.check; removeSelectedQualOnCancel(raceBera,'raceBera')" ng-show="raceBeraGrouping.check">Cancel</button>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <table class="table" id="raceform">
                                            <thead>
                                            <tr>
                                                <th></th>
                                                <th ng-hide="raceBeraGrouping.check">{{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                                <th ng-hide="raceBeraGrouping.check">MIN</th>
                                                <th ng-hide="raceBeraGrouping.check">MAX</th>
                                                <th ng-if="liveSurveyEditingStep == 'editStep1' && !raceBeraGrouping.check">FIELDED</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr ng-repeat="data in raceBera" ng-if="data.selected == true && !isGrouped('raceBera')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': raceBeraGrouping.check == true? raceBeraGrouping.check : raceBeraGrouping.check = false}" ng-click="data.setGrupActive = (raceBeraGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                <td class="td-th-class" >
                                                    <br>
                                                    <label>
                                                        {{data.name}}
                                                   </label>
                                                </td>
                                                <td class="td-th-class" ng-hide="raceBeraGrouping.check">
                                                    <input  type="number" id="num" class=" text-line" onkeypress='return validateCompletes(event);'  ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id ,raceBera, rbQuotaFlag.rbFlxValue, 'rbSw')" ng-keypress="clearNumberChange(raceBera, $index)">&nbsp;&nbsp;&nbsp;
                                                    <input type="text" id="per" class=" text-line"  maxlength="3" onkeypress='return validateCompletes(event);' ng-model="data.per"  ng-keyup="quotaPerChange(data.id ,raceBera, rbQuotaFlag.rbFlxValue, 'rbSw')" ng-readonly="!properties.numberOfCompletes || !data.selected">%
                                                   
                                                </td>
                                                <td class="td-th-class" ng-hide="raceBeraGrouping.check">
                                                    <input type="number" id="min" class="text-line" onkeypress='return validateQty(event);'  ng-model="data.minimum"  ng-readonly="true">
                                                </td>
                                                <td class="td-th-class" ng-hide="raceBeraGrouping.check">
                                                    <input type="number" id="max" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum" ng-readonly="true">
                                                </td>
                                                <td class="td-th-class" ng-if="liveSurveyEditingStep == 'editStep1' && !raceBeraGrouping.check">
                                                    <input type="number" id="achieved" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved" ng-readonly="true">
                                                </td>
                                            </tr>

                                            <!-- With Grouping -->
                                            <tr ng-repeat="data in groupingRaceBeraModel" ng-if="data.selected == true && isGrouped('raceBera')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': raceBeraGrouping.check == true? raceBeraGrouping.check : raceBeraGrouping.check = false}" ng-click="data.setGrupActive = (raceBeraGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                <td class="td-th-class" ng-hide="data.condditionGroup && raceBeraGrouping.check">
                                                    <br>
                                                    <i class="fa fa-chain-broken" aria-hidden="true" ng-click="ungroupedConditionGrouping( 'raceBera', data)" ng-show="data.condditionGroup" style="cursor: pointer; font-size: 20px;"></i>
                                                    <label>
                                                        {{data.name}}
                                                   </label>
                                                </td>
                                                <td class="td-th-class" ng-hide="raceBeraGrouping.check || data.condditionGroup && raceBeraGrouping.check">
                                                    <input  type="number" id="num" class=" text-line" onkeypress='return validateCompletes(event);'  ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id ,groupingRaceBeraModel, rbQuotaFlag.rbFlxValue, 'rbSw')" ng-keypress="clearNumberChange(groupingRaceBeraModel, $index)" ng-class="{'hoverTr-Text':trhovering}">&nbsp;&nbsp;&nbsp;
                                                    <input type="text" id="per" class=" text-line"  maxlength="3" onkeypress='return validateCompletes(event);' ng-model="data.per"  ng-keyup="quotaPerChange(data.id ,groupingRaceBeraModel, rbQuotaFlag.rbFlxValue, 'rbSw')" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-class="{'hoverTr-Text':trhovering}">%
                                                   
                                                </td>
                                                <td class="td-th-class" ng-hide="raceBeraGrouping.check || data.condditionGroup && raceBeraGrouping.check">
                                                    <input type="number" id="min" class="text-line" onkeypress='return validateQty(event);'  ng-model="data.minimum"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                </td>
                                                <td class="td-th-class" ng-hide="raceBeraGrouping.check || data.condditionGroup && raceBeraGrouping.check">
                                                    <input type="number" id="max" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum" ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                </td>
                                                <td class="td-th-class" ng-if="liveSurveyEditingStep == 'editStep1' && !raceBeraGrouping.check">
                                                    <input type="number" id="achieved" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved" ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 text-center">
                                <div class="center-block">
                                    <p><b>Total Remaining</b></p>
                                    <p><b>
                                            <span ng-if="quotaTotalRemRace == null || quotaTotalRemRace == undefined">
                                                {{completesNeeded | number:0}}
                                            </span>
                                            <span>{{quotaTotalRemRace | number:0}}</span>
                                        </b>
                                    </p>
                                    <span>
                                        <button class="btn btn-primary addQuotas-btn" ng-click="addRbQuota(rbQuotaFlag.rbFlxValue, $event)" ng-disabled="quotaTotalRemRace !=0 || rbAllocationsLessThanFielded" data-dismiss="modal" ng-class="{inactiveButton: !raceBeraGrouping.check}">Apply</button>
                                        <!-- <button class="btn btn-primary addQuotas-btn" ng-click="addRaceQuota(rbQuotaFlag.rbFlxValue, $event); addToNesting('race', race, $event);" ng-disabled="quotaTotalRemRace !=0 || raceAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest</button> -->
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--hispanic modal-->
        <div id="hispanicModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click="commonResetModal($event, hispanic, hisQuotaFlag.resetHisOri, quotaTotalRemRace)"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                            <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                                <h2 class="text-center">Quotas for Hispanic Origin:</h2>
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                <span><label class="status pull-middle quota-flex-btn"><input type="checkbox" id="hispanicSw" checked  ng-click ="setHispanicFlex($event, hispanic, hisQuotaFlag.hispanicFlxValue)" ng-model="hisQuotaFlag.hispanicFlx"><div class="slider round racer"></div></label>&nbsp; &nbsp; by &nbsp; &nbsp; <input type="text" class="text-line disabled-state" maxlength="2"  onkeypress='return validateQty(event);' ng-model="hisQuotaFlag.hispanicFlxValue" ng-readonly="!properties.numberOfCompletes || !hisQuotaFlag.hispanicFlx"  ng-keyup="quotaPercentageChange(hispanic, hisQuotaFlag.hispanicFlxValue)"  ng-readonly="!properties.numberOfCompletes || !hisQuotaFlag.hispanicFlx" ng-disabled="!hisQuotaFlag.hispanicFlx"><span>%</span>
                                </span>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <table class="table" id="raceform">
                                            <thead>
                                            <tr>
                                                <th></th>
                                                <th>{{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                                <th>MIN</th>
                                                <th>MAX</th>
                                                <th ng-if="liveSurveyEditingStep == 'editStep1'">FIELDED</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr ng-repeat="data in hispanic" ng-if="data.selected == true">
                                                <td class="td-th-class" >
                                                    <br>
                                                    <label>
                                                        {{data.name}}
                                                   </label>
                                                </td>
                                                <td class="td-th-class" >
                                                    <input  type="number" id="num" class=" text-line" onkeypress='return validateCompletes(event);'  ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id ,hispanic, hisQuotaFlag.hispanicFlxValue, 'rbSw')" ng-keypress="clearNumberChange(hispanic, $index)">&nbsp;&nbsp;&nbsp;
                                                    <input type="text" id="per" class=" text-line"  maxlength="3" onkeypress='return validateCompletes(event);' ng-model="data.per"  ng-keyup="quotaPerChange(data.id ,hispanic, hisQuotaFlag.hispanicFlxValue, 'hispanicSw')" ng-readonly="!properties.numberOfCompletes || !data.selected">%
                                                   
                                                </td>
                                                <td class="td-th-class" >
                                                    <input type="number" id="min" class="text-line" onkeypress='return validateQty(event);'  ng-model="data.minimum"  ng-readonly="true">
                                                </td>
                                                <td class="td-th-class">
                                                    <input type="number" id="max" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum" ng-readonly="true">
                                                </td>
                                                <td class="td-th-class" ng-if="liveSurveyEditingStep == 'editStep1'">
                                                    <input type="number" id="achieved" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved" ng-readonly="true">
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 text-center">
                                <div class="center-block">
                                    <p><b>Total Remaining</b></p>
                                    <p><b>
                                            <span ng-if="quotaTotalRemRace == null || quotaTotalRemRace == undefined">
                                                {{completesNeeded | number:0}}
                                            </span>
                                            <span>{{quotaTotalRemRace | number:0}}</span>
                                        </b>
                                    </p>
                                    <span>
                                        <button class="btn btn-primary addQuotas-btn" ng-click="addHispanicQuota(hisQuotaFlag.hispanicFlxValue, $event)" ng-disabled="quotaTotalRemRace !=0 || hispanicAllocationsLessThanFielded" data-dismiss="modal">Apply</button>
                                        <!-- <button class="btn btn-primary addQuotas-btn" ng-click="addRaceQuota(rbQuotaFlag.rbFlxValue, $event); addToNesting('race', race, $event);" ng-disabled="quotaTotalRemRace !=0 || raceAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest</button> -->
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--relationship modal-->
        <div id="rlnModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click="commonResetModal($event, relation, rlnQuotaFlag.resetRel, quotaTotalRemRace)"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                                <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                                <h2 class="text-center">Quotas for Relationship:</h2>
                                <p class="text-center" ng-show="isNested('relationships')">Applying a layered quota will clear this qualification from your auto-nested quotas, causing them to recalculate.  Please verify the auto-nested quotas modal before selecting suppliers.</p>
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                <span><label class="status pull-middle quota-flex-btn"><input type="checkbox" checked id="rlnSw"  ng-click ="setRelationFlex($event, relation, rlnQuotaFlag.rlnFlxValue)" ng-model="rlnQuotaFlag.rlnFlx"><div class="slider round relationr"></div></label>&nbsp; &nbsp; by &nbsp; &nbsp; <input type="text" class="text-line disabled-state" maxlength="2"  onkeypress='return validateQty(event);' ng-model="rlnQuotaFlag.rlnFlxValue" ng-hide ="flexible == false" ng-keyup="quotaPercentageChange(relation, rlnQuotaFlag.rlnFlxValue); groupingUpdateFleaxibility('relationships', newrelationModal, rlnQuotaFlag.rlnFlxValue)" ng-readonly="!properties.numberOfCompletes || !rlnQuotaFlag.rlnFlx" ng-disabled="!rlnQuotaFlag.rlnFlx"><span>%</span>
                                </span>
                            </div>
                            <!-- PD-961 -->
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3 text-center" ><br/><!-- &nbsp; &nbsp;&nbsp; &nbsp; -->
                                <button class="btn btn-primary btn-md grupCondtion submit-btn" type="button" ng-click="rlnGrouping.check = !rlnGrouping.check" ng-hide="rlnGrouping.check">Group Conditions</button>
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="selectedQuotaGrouping('relationships',relation); rlnGrouping.check = !rlnGrouping.check" ng-show="rlnGrouping.check">Group</button>
                                <!-- &nbsp; &nbsp; &nbsp; &nbsp; -->
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="rlnGrouping.check = !rlnGrouping.check; removeSelectedQualOnCancel(relation,'relation')" ng-show="rlnGrouping.check">Cancel</button>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <table class="table" id="rlnform">
                                            <thead>
                                            <tr >
                                                <th></th>
                                                <th ng-hide="rlnGrouping.check">{{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                                <th ng-hide="rlnGrouping.check">MIN</th>
                                                <th ng-hide="rlnGrouping.check">MAX</th>
                                                <th ng-if="liveSurveyEditingStep == 'editStep1' && !rlnGrouping.check">FIELDED</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="data in relation" ng-if = "data.selected == true && !isGrouped('relationships')"
                                                 ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': rlnGrouping.check == true? rlnGrouping.check : rlnGrouping.check = false}" ng-click="data.setGrupActive = (rlnGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                    <td >
                                                        <br>
                                                        <label>
                                                        <!-- <input type="checkbox"  class="modalCheckbox" ng-model="data.selected"  ng-true-value="true" ng-false-value="false"  ng-change="checkedOption(data.id, data.selected, relation, sltRelation, rlnFlxValue.vlue, data.number,'rlnSw')"> -->
                                                            {{data.name}}
                                                        </label>

                                                    </td>
                                                    <td ng-hide="rlnGrouping.check">
                                                        <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id, relation, rlnQuotaFlag.rlnFlxValue, 'rlnSw')" ng-keypress="clearNumberChange(relation,$index)">&nbsp;&nbsp;&nbsp;
                                                        <input type="text" class=" text-line" maxlength="3" ng-keyup ="quotaPerChange(data.id, relation, rlnQuotaFlag.rlnFlxValue, 'rlnSw')" onkeypress='return validateCompletes(event);' ng-model="data.per" ng-readonly="!properties.numberOfCompletes || !data.selected">%
                                                    </td>
                                                    <td ng-hide="rlnGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true">
                                                    </td>
                                                    <td ng-hide="rlnGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true">
                                                    </td>
                                                    <td ng-if="liveSurveyEditingStep == 'editStep1' && !rlnGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved"  ng-readonly="true">
                                                    </td>
                                                </tr>

                                                <!-- With Grouping -->
                                                    <tr ng-repeat="data in newrelationModal" ng-if = "data.selected == true && isGrouped('relationships')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': rlnGrouping.check == true? rlnGrouping.check : rlnGrouping.check = false}" ng-click="data.setGrupActive = (rlnGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                        <td ng-hide="data.condditionGroup && rlnGrouping.check">
                                                            <br>
                                                            <i class="fa fa-chain-broken" aria-hidden="true" ng-click="ungroupedConditionGrouping( 'relationships', data)" ng-show="data.condditionGroup" style="cursor: pointer; font-size: 20px;"></i>
                                                            <label>
                                                                {{data.name}}
                                                            </label>

                                                        </td>
                                                        <td ng-hide="rlnGrouping.check || data.condditionGroup && rlnGrouping.check">
                                                            <input type="number" class="text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id, newrelationModal, rlnFlxValue.vlue, 'rlnSw')" ng-keypress="clearNumberChange(newrelationModal,$index)" ng-class="{'hoverTr-Text':trhovering}">&nbsp;&nbsp;&nbsp;
                                                            <input type="text" class=" text-line" maxlength="3" ng-keyup ="quotaPerChange(data.id, newrelationModal, rlnFlxValue.vlue, 'rlnSw')" onkeypress='return validateCompletes(event);' ng-model="data.per" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-class="{'hoverTr-Text':trhovering}">%
                                                        </td>
                                                        <td ng-hide="rlnGrouping.check || data.condditionGroup && rlnGrouping.check">
                                                            <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                        </td>
                                                        <td ng-hide="rlnGrouping.check || data.condditionGroup && rlnGrouping.check">
                                                            <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                        </td>
                                                        <td ng-if="liveSurveyEditingStep == 'editStep1' && !rlnGrouping.check">
                                                            <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                        </td>
                                                    </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 text-center">
                                <div class="center-block">
                                    <!-- <div class="checkbox">
                                        <input class="checkboxInput" type="checkbox" ng-model="rlnGrouping.check" />
                                        <label ng-click = "rlnGrouping.check = !rlnGrouping.check">Group the remaining conditions as a single quota & allocate the remaining the completes</label>
                                    </div> -->
                                    <p><b>Total Remaining</b></p>
                                    <p><b>
                                            <!--<span ng-repeat="option in race track by $index">
                                                <span ng-show="$last">{{option.totalRem || 0}}</span>
                                            </span>-->
                                            <span ng-if="quotaTotalRemRace == null || quotaTotalRemRace == undefined">
                                                {{completesNeeded | number:0}}
                                            </span>
                                            <span>{{quotaTotalRemRace | number:0}}</span>
                                        </b>
                                    </p>
                                    <span>
                                        <button class="btn btn-primary addQuotas-btn groupedButton" ng-click="addRelationshipQuota(rlnQuotaFlag.rlnFlxValue, $event)" data-dismiss="modal">Apply</button>
                                        <button class="btn btn-primary addQuotas-btn" ng-click="addRelationshipQuota(rlnQuotaFlag.rlnFlxValue, $event)" ng-disabled="quotaTotalRemRace !=0 || rlnAllocationsLessThanFielded" data-dismiss="modal" ng-class="{inactiveButton: !rlnGrouping.check}">Apply</button>
                                        <button class="btn btn-primary addQuotas-btn" ng-click="addRelationshipQuota(rlnQuotaFlag.rlnFlxValue, $event); addToNesting('relationships', conditionGroupingArray.relationships?conditionGroupingArray.relationships:relation, $event)" ng-disabled="quotaTotalRemRace !=0 || rlnAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest</button>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- children modal-->
        <div id="chldModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes"> 
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click="childResetModal($event, children, childQuotaFlag.chldFlxValue)"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                                <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                                <h2 class="text-center">Quotas for Children:</h2>
                                <p class="text-center" ng-show="isNested('children')">Applying a layered quota will clear this qualification from your auto-nested quotas, causing them to recalculate.  Please verify the auto-nested quotas modal before selecting suppliers.</p>
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                <span><label class="status pull-middle quota-flex-btn"><input type="checkbox" name="my-checkbox" checked id="chldSw"  ng-click="setChldFlex($event, chldTempArr, childQuotaFlag.chldFlxValue)" ng-model="childQuotaFlag.chldFlx"><div class="slider round childrenr"></div></label>&nbsp; &nbsp; by &nbsp; &nbsp;<input type="text" class="text-line disabled-state" maxlength="2"  onkeypress="return validateQty(event)" ng-model="childQuotaFlag.chldFlxValue" ng-keyup="chldPercentageChange(chldTempArr, childQuotaFlag.chldFlxValue)" ng-readonly="!properties.numberOfCompletes || data.chldFlx == false"><span>%</span>
                                </span>
                            </div>
                        </div>
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-xs-12 col-sm-10 col-md-10 col-md-offset-1">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <table class="table" id="chldform">
                                            <thead>
                                            <tr >
                                                <th>&nbsp;</th>
                                                <th>AGE
                                                    <span class="dropdown survey-status"><button class="btn btn-default dropdown-toggle childButton" type="button" id="More_Actions" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">{{childAgeUnit.name}}<i class="fa fa-angle-down" aria-hidden="true"></i></button>
                                                        <ul class="dropdown-menu" aria-labelledby="More_Actions">
                                                            <li><a href="" ng-click="onChangeChildAgeUnit('month')">month</a></li>
                                                            <li><a href="" ng-click="onChangeChildAgeUnit('year')">year</a></li>
                                                        </ul>
                                                    </span>
                                                </th>
                                                <th>GENDER</th>
                                                <th># OF {{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                                <th>MIN</th>
                                                <th>MAX</th>
                                                <th ng-if="srvId">FIELDED</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="data in chldTempArr.have" chld-row="" units="{{childAgeUnit.name}}" ng-if="showChildrenRow(chldTempArr.have[0].id)">
                                                </tr>
                                                <tr ng-repeat="data in chldTempArr.no" ng-if="showChildrenRow(chldTempArr.no[0].id)">
                                                    <td>No Children</td>
                                                    <td>&nbsp;</td>
                                                    <td>&nbsp;</td>
                                                    <td class="td-th-class"> 
                                                        <input type="number" class=" text-line" placeholder="" onkeypress="return validateQty(event);" ng-model="data.number" ng-keyup="chldNumberChange(chldTempArr, chldFlxValue.vlue)" >
                                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
                                                        <input type="text" class=" text-line" maxlength="3" onkeypress="return validateQty(event);" ng-model="data.per"  ng-keyup="chldPerChange(chldTempArr, chldFlxValue.vlue)" >% 
                                                    </td>
                                                    <td class="td-th-class"> 
                                                        <input type="number" class="text-line" onkeypress="return validateQty(event) " ng-model="data.minimum" ng-readonly="true" ></td> <td class="td-th-class"> 
                                                        <input type="number" class="text-line" onkeypress="return validateQty(event)" ng-model="data.maximum" ng-readonly="true"><span ng-if="$index==0"></td> <td class="td-th-class"> 
                                                        <input type="number" ng-if="srvId" class="text-line" onkeypress="return validateQty(event)" ng-model="data.achieved" ng-readonly="true">
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 text-center">
                        <div class="center-block">
                            <p><b>Total Remaining</b></p>
                            <p><b>
                                    <span ng-if="chldTotalRemRace == null || chldTotalRemRace == undefined">
                                            {{completesNeeded | number:0}}
                                        </span>
                                        <span>{{chldTotalRemRace | number:0}}</span>
                                </b>
                            </p>
                        </div>
                        <span ng-repeat="option in chldTempArr track by $index">
                            <span ng-show="$last">
                                <button class="btn btn-primary addQuotas-btn" ng-click="chldQuota($event)" ng-disabled="chldTotalRemRace !=0" data-dismiss="modal">Apply</button>
                                <button class="btn btn-primary addQuotas-btn" ng-click="chldQuota($event); addToNesting('children', chldTempArr, $event)" ng-disabled="chldTotalRemRace !=0" data-dismiss="modal">Apply & Nest </button>
                            </span>
                        </span>
                    </div>
                </div>

                    </div>
                </div>
            </div>
        </div>

        <!--education modal-->
        <div id="eduModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click ="commonResetModal($event, education, eduQuotaFlag.resetEdu, quotaTotalRemRace)"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                            <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                                <h2 class="text-center">Quotas for Education:</h2>
                                <p class="text-center" ng-show="isNested('educations')">Applying a layered quota will clear this qualification from your auto-nested quotas, causing them to recalculate.  Please verify the auto-nested quotas modal before selecting suppliers.</p>
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                <span><label class="status pull-middle quota-flex-btn"><input type="checkbox" checked id="eduSw"  ng-click ="setEducationFlex($event, education, eduQuotaFlag.eduFlxValue)" ng-model="eduQuotaFlag.eduFlx"><div class="slider round educationr"></div></label>&nbsp; &nbsp; by &nbsp; &nbsp; <input type="text" class="text-line disabled-state" maxlength="2"  onkeypress='return validateQty(event);' ng-model="eduQuotaFlag.eduFlxValue" ng-keyup="quotaPercentageChange(education, eduQuotaFlag.eduFlxValue); groupingUpdateFleaxibility('educations', groupingeducationModal, eduQuotaFlag.eduFlxValue)" ng-readonly="!properties.numberOfCompletes || !eduQuotaFlag.eduFlx" ng-disabled="!eduQuotaFlag.eduFlx"><span>%</span>
                                </span>
                            </div>
                            <!-- PD-961 -->
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3 text-center" ><br/><!-- &nbsp; &nbsp;&nbsp; &nbsp; -->
                                <button class="btn btn-primary btn-md grupCondtion submit-btn" type="button" ng-click="eduGrouping.check = !eduGrouping.check" ng-hide="eduGrouping.check">Group Conditions</button>
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="selectedQuotaGrouping('educations',education); eduGrouping.check = !eduGrouping.check" ng-show="eduGrouping.check">Group</button>
                                <!-- &nbsp; &nbsp; &nbsp; &nbsp; -->
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="eduGrouping.check = !eduGrouping.check; removeSelectedQualOnCancel(education,'education')" ng-show="eduGrouping.check">Cancel</button>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <table class="table" id="eduform">
                                            <thead>
                                            <tr >
                                                <th></th>
                                                <th ng-hide="eduGrouping.check">{{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                                <th ng-hide="eduGrouping.check">MIN</th>
                                                <th ng-hide="eduGrouping.check">MAX</th>
                                                <th ng-if="liveSurveyEditingStep == 'editStep1' && !eduGrouping.check">FIELDED</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr ng-repeat="data in  education" ng-if = "data.selected == true && !isGrouped('educations')"
                                             ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': eduGrouping.check == true? eduGrouping.check : eduGrouping.check = false}" ng-click="data.setGrupActive = (eduGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                <td class="td-th-class">
                                                    <br>
                                                    <label>
                                                    <!-- <input type="checkbox"  class="modalCheckbox" ng-model="data.selected"  ng-true-value="true" ng-false-value="false" ng-change="checkedOption(data.id, data.selected, education, sltEducation, eduQuotaFlag.eduFlxValue, data.number,'eduSw')"> -->
                                                        {{data.name}}
                                                    </label>
                                                </td>
                                                <td class="td-th-class" ng-hide="eduGrouping.check">
                                                    <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id, education, eduQuotaFlag.eduFlxValue, 'eduSw')" ng-keypress="clearNumberChange(education,$index)" >&nbsp;&nbsp;&nbsp;
                                                    <input type="text" class="text-line" maxlength="3" onkeypress='return validateCompletes(event);' ng-model="data.per" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaPerChange(data.id, education, eduQuotaFlag.eduFlxValue, 'eduSw')">%
                                                </td>
                                                <td class="td-th-class" ng-hide="eduGrouping.check">
                                                    <input type="number" class="text-line" onkeypress='return validateQty(event);'  ng-model="data.minimum"  ng-readonly="true">
                                                </td>
                                                <td class="td-th-class" ng-hide="eduGrouping.check">
                                                    <input type="number" class="text-line" onkeypress='return validateQty(event);'   ng-model="data.maximum"  ng-readonly="true">
                                                </td>
                                                <td class="td-th-class" ng-if="liveSurveyEditingStep == 'editStep1' && !eduGrouping.check">
                                                    <input type="number" class="text-line" onkeypress='return validateQty(event);'   ng-model="data.achieved"  ng-readonly="true">
                                                </td>
                                            </tr>

                                            <!-- Grouping row -->
                                                    <tr ng-repeat="data in  groupingeducationModal" ng-if = "data.selected == true && isGrouped('educations')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': eduGrouping.check == true? eduGrouping.check : eduGrouping.check = false}" ng-click="data.setGrupActive = (eduGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                    
                                                        <td class="td-th-class" ng-hide="data.condditionGroup && eduGrouping.check">
                                                            <br>
                                                            <i class="fa fa-chain-broken" aria-hidden="true"
                                                            ng-click="ungroupedConditionGrouping( 'educations', data)" ng-show="data.condditionGroup" style="cursor: pointer; font-size: 20px;"></i>
                                                            <label>
                                                                {{data.name}}
                                                            </label>
                                                        </td>
                                                        <td class="td-th-class" ng-hide="eduGrouping.check || data.condditionGroup && eduGrouping.check">
                                                            <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id, groupingeducationModal, eduFlxValue.vlue, 'eduSw')" ng-keypress="clearNumberChange(groupingeducationModal,$index)" >&nbsp;&nbsp;&nbsp;
                                                            <input type="text" class="text-line" maxlength="3" onkeypress='return validateCompletes(event);' ng-model="data.per" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaPerChange(data.id, groupingeducationModal, eduFlxValue.vlue, 'eduSw')">%
                                                        </td>
                                                        <td class="td-th-class" ng-hide="eduGrouping.check || data.condditionGroup && eduGrouping.check">
                                                            <input type="number" class="text-line" onkeypress='return validateQty(event);'  ng-model="data.minimum"  ng-readonly="true">
                                                        </td>
                                                        <td class="td-th-class" ng-hide="eduGrouping.check || data.condditionGroup && eduGrouping.check">
                                                            <input type="number" class="text-line" onkeypress='return validateQty(event);'   ng-model="data.maximum"  ng-readonly="true">
                                                        </td>
                                                        <td class="td-th-class" ng-if="liveSurveyEditingStep == 'editStep1' && !eduGrouping.check">
                                                            <input type="number" class="text-line" onkeypress='return validateQty(event);'   ng-model="data.achieved"  ng-readonly="true">
                                                        </td>
                                                    </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 text-center">
                                <div class="center-block">
                                    <!-- <div class="checkbox">
                                        <input class="checkboxInput" type="checkbox" ng-model="eduGrouping.check" />
                                        <label ng-click = "eduGrouping.check = !eduGrouping.check">Group the remaining conditions as a single quota & allocate the remaining the completes</label>
                                    </div> -->
                                    <p><b>Total Remaining</b></p>
                                    <p><b>
                                            <span ng-if="quotaTotalRemRace == null || quotaTotalRemRace == undefined">
                                                {{completesNeeded | number:0}}
                                            </span>
                                            <span>{{quotaTotalRemRace | number:0}}</span>
                                        </b>
                                    </p>
                                    <span>  
                                        <button class="btn btn-primary addQuotas-btn groupedButton" ng-click="addEducationQuota(eduQuotaFlag.eduFlxValue, $event)" data-dismiss="modal">Apply</button>
                                        <button class="btn btn-primary addQuotas-btn" ng-click="addEducationQuota(eduQuotaFlag.eduFlxValue, $event)" ng-disabled="quotaTotalRemRace !=0 || eduAllocationsLessThanFielded" data-dismiss="modal" ng-class="{inactiveButton: eduGrouping.check}">Apply</button>
                                        <button class="btn btn-primary addQuotas-btn" ng-click="addEducationQuota(eduQuotaFlag.eduFlxValue, $event); addToNesting('educations', conditionGroupingArray.educations?conditionGroupingArray.educations:education, $event)" ng-disabled="quotaTotalRemRace !=0 || eduAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest</button>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--employement modal-->
        <div id="empModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click="commonResetModal($event, employement, empQuotaFlag.resetEmp, quotaTotalRemRace)"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                            <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                                <h2 class="text-center">Quotas for Employement:</h2>
                                <p class="text-center" ng-show="isNested('employments')">Applying a layered quota will clear this qualification from your auto-nested quotas, causing them to recalculate.  Please verify the auto-nested quotas modal before selecting suppliers.</p>
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                 <span><label class="status pull-middle quota-flex-btn"><input type="checkbox" checked id="empSw"  ng-click ="setEmployementFlex($event, employement, empQuotaFlag.empFlxValue)" ng-model="empQuotaFlag.empFlx"><div class="slider round employeer"></div></label>&nbsp; &nbsp; by &nbsp; &nbsp; <input type="text" class="text-line disabled-state" maxlength="2"  onkeypress='return validateQty(event);' ng-model="empQuotaFlag.empFlxValue" ng-readonly="!properties.numberOfCompletes || !empQuotaFlag.empFlx"  ng-keyup="quotaPercentageChange(employement, empQuotaFlag.empFlxValue); groupingUpdateFleaxibility('employments', groupingemploymentModal, empQuotaFlag.empFlxValue)" ng-disabled="!empQuotaFlag.empFlx"><span>%</span>
                                 </span>
                            </div>
                            <!-- PD-961 -->
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3 text-center" ><br/><!-- &nbsp; &nbsp;&nbsp; &nbsp; -->
                                <button class="btn btn-primary btn-md grupCondtion submit-btn" type="button" ng-click="empGrouping.check = !empGrouping.check" ng-hide="empGrouping.check">Group Conditions</button>
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="selectedQuotaGrouping('employments',employement); empGrouping.check = !empGrouping.check" ng-show="empGrouping.check">Group</button>
                                <!-- &nbsp; &nbsp; &nbsp; &nbsp; -->
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="empGrouping.check = !empGrouping.check; removeSelectedQualOnCancel(employement,'employment')" ng-show="empGrouping.check">Cancel</button>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <table class="table" id="emplform">
                                            <thead>
                                            <tr >
                                                <th></th>
                                                <th ng-hide="empGrouping.check">{{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                                <th ng-hide="empGrouping.check">MIN</th>
                                                <th ng-hide="empGrouping.check">MAX</th>
                                                <th ng-if="liveSurveyEditingStep == 'editStep1' && !empGrouping.check">FIELDED</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr ng-repeat="data in  employement" ng-if = "data.selected == true && !isGrouped('employments')"
                                             ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': empGrouping.check == true? empGrouping.check : empGrouping.check = false}" ng-click="data.setGrupActive = (empGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                <td class="td-th-class">
                                                    <br>
                                                    <label>
                                                    <!-- <input type="checkbox"  class="modalCheckbox" ng-model="data.selected"  ng-true-value="true" ng-false-value="false" ng-change="checkedOption(data.id, data.selected, employement, sltEmployment, empQuotaFlag.empFlxValue, data.number,'empSw')"> -->
                                                        {{data.name}}
                                                    </label> &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;
                                                </td>
                                                <td class="td-th-class" ng-hide="empGrouping.check">
                                                    <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id, employement, empQuotaFlag.empFlxValue, 'empSw')" ng-keypress="clearNumberChange(employement,$index)">&nbsp;&nbsp;&nbsp;
                                                    <input type="text" class=" text-line" maxlength="3" onkeypress='return validateCompletes(event);' ng-model="data.per" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaPerChange(data.id, employement, empQuotaFlag.empFlxValue, 'empSw')">%
                                                </td>
                                                <td class="td-th-class" ng-hide="empGrouping.check">
                                                    <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true">
                                                </td>
                                                <td class="td-th-class" ng-hide="empGrouping.check">
                                                    <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true">
                                                </td>
                                                <td class="td-th-class" ng-if="liveSurveyEditingStep == 'editStep1' && !empGrouping.check">
                                                    <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved"  ng-readonly="true">
                                                </td>
                                            </tr>
                                            <!-- With Grouping -->

                                                <tr ng-repeat="data in  groupingemploymentModal" ng-if = "data.selected == true && isGrouped('employments')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': empGrouping.check == true? empGrouping.check : empGrouping.check = false}" ng-click="data.setGrupActive = (empGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                    <td class="td-th-class" ng-hide="data.condditionGroup && empGrouping.check">
                                                        <br>
                                                        <i class="fa fa-chain-broken" aria-hidden="true"
                                                        ng-click="ungroupedConditionGrouping( 'employments', data)" ng-show="data.condditionGroup" style="cursor: pointer; font-size: 20px;"></i>
                                                        <label>
                                                            {{data.name}}
                                                        </label> &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;
                                                    </td>
                                                    <td class="td-th-class" ng-hide="empGrouping.check || data.condditionGroup && empGrouping.check">
                                                        <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id, groupingemploymentModal, empFlxValue.vlue, 'empSw')" ng-keypress="clearNumberChange(groupingemploymentModal,$index)">&nbsp;&nbsp;&nbsp;
                                                        <input type="text" class=" text-line" maxlength="3" onkeypress='return validateCompletes(event);' ng-model="data.per" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaPerChange(data.id, groupingemploymentModal, empFlxValue.vlue, 'empSw')">%
                                                    </td>
                                                    <td class="td-th-class" ng-hide="empGrouping.check || data.condditionGroup && empGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true">
                                                    </td>
                                                    <td class="td-th-class" ng-hide="empGrouping.check || data.condditionGroup && empGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true">
                                                    </td>
                                                    <td class="td-th-class" ng-if="liveSurveyEditingStep == 'editStep1' && !empGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved"  ng-readonly="true">
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 text-center">
                                <div class="center-block">
                                    <!-- <div class="checkbox">
                                        <input class="checkboxInput" type="checkbox" ng-model="empGrouping.check" />
                                        <label ng-click = "empGrouping.check = !empGrouping.check">Group the remaining conditions as a single quota & allocate the remaining the completes</label>
                                    </div> -->
                                    <p><b>Total Remaining</b></p>
                                    <p><b>
                                            <span ng-if="quotaTotalRemRace == null || quotaTotalRemRace == undefined">
                                                {{completesNeeded | number:0}}
                                            </span>
                                            <span>{{quotaTotalRemRace | number:0}}</span>
                                        </b>
                                    </p>
                                    <span>
                                        <button class="btn btn-primary addQuotas-btn groupedButton" ng-click="addEmployementQuota(empQuotaFlag.empFlxValue, $event)" data-dismiss="modal">Apply</button>
                                        <button class="btn btn-primary addQuotas-btn" ng-click="addEmployementQuota(empQuotaFlag.empFlxValue, $event)" ng-disabled="quotaTotalRemRace !=0 || empAllocationsLessThanFielded" data-dismiss="modal" ng-class="{inactiveButton: !eduGrouping.check}">Apply</button>
                                        <button class="btn btn-primary addQuotas-btn" ng-click="addEmployementQuota(empQuotaFlag.empFlxValue, $event); addToNesting('employments', conditionGroupingArray.employments?conditionGroupingArray.employments:employement, $event)" ng-disabled="quotaTotalRemRace !=0 || empAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest</button>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--device modal-->
        <div id="dvcModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-body">
                            <div class="feasibility-header">
                                <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click="commonResetModal($event, deviceInfo, dvcQuotaFlag.resetDev, quotaTotalRemRace)"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                                <div class="clearfix"></div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12 col-sm-4 col-md-4 col-md-offset-4  col-sm-offset-4">
                                    <h2 class="text-center">Quotas for Device:</h2>
                                    <p class="text-center" ng-show="isNested('device')">Applying a layered quota will clear this qualification from your auto-nested quotas, causing them to recalculate.  Please verify the auto-nested quotas modal before selecting suppliers.</p>
                                </div>
                                <div class="col-xs-12 col-md-4 col-sm-4 col-md-offset-4 col-sm-offset-4 text-center">
                                    <p>FLEXIBLE</p>
                                    <span><label class="status pull-middle quota-flex-btn"><input type="checkbox" checked id="devcSw"  ng-click ="setDeviceFlex($event, deviceInfo, dvcQuotaFlag.dvcFlxValue)" ng-model="dvcQuotaFlag.dvcFlx"><div class="slider round devicer"></div></label>&nbsp; &nbsp; by &nbsp; &nbsp;
                                         <input type="text" class="text-line disabled-state" maxlength="2"  onkeypress='return validateQty(event);' ng-model="dvcQuotaFlag.dvcFlxValue"  ng-keyup="quotaPercentageChange(deviceInfo, dvcQuotaFlag.dvcFlxValue); groupingUpdateFleaxibility('device', groupingDeviceModel, dvcQuotaFlag.dvcFlxValue)" ng-readonly="!properties.numberOfCompletes || !dvcQuotaFlag.dvcFlx" ng-disabled="!dvcQuotaFlag.dvcFlx"><span>%</span>
                                    </span>
                                </div>
                                <!-- PD-1402 -->

                                <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3 text-center" ><br/>
                                    <button class="btn btn-primary btn-md grupCondtion submit-btn" type="button" ng-click="deviceGrouping.check = !deviceGrouping.check" ng-hide="deviceGrouping.check">Group Conditions</button>
                                    <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="selectedQuotaGrouping('device',deviceInfo); deviceGrouping.check = !deviceGrouping.check" ng-show="deviceGrouping.check">Group</button>
                                    <!-- &nbsp; &nbsp; &nbsp; &nbsp; -->
                                    <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="deviceGrouping.check = !deviceGrouping.check; removeSelectedQualOnCancel(deviceInfo,'device')" ng-show="deviceGrouping.check">Cancel</button>
                                </div>

                            </div>
                            <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                                <div class="panel">
                                    <div class="panel-body">
                                        <div class="table-responsive">
                                            <table class="table" id="devform">
                                                <thead>
                                                <tr >
                                                    <th></th>
                                                    <th ng-hide="deviceGrouping.check">{{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                                    <th ng-hide="deviceGrouping.check">MIN</th>
                                                    <th ng-hide="deviceGrouping.check">MAX</th>
                                                    <th ng-if="liveSurveyEditingStep == 'editStep1' && !deviceGrouping.check">FIELDED</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr ng-repeat="data in deviceInfo" ng-if = "data.selected == true && !isGrouped('device')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': deviceGrouping.check == true? deviceGrouping.check : deviceGrouping.check = false}" ng-click="data.setGrupActive = (deviceGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                    <td class="td-th-class">
                                                        <br>
                                                        {{data.name}} &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;
                                                    </td>
                                                    <td class="td-th-class" ng-hide="deviceGrouping.check">
                                                        <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id, deviceInfo, dvcQuotaFlag.dvcFlxValue, 'devcSw')" ng-keypress="clearNumberChange(deviceInfo,$index)">&nbsp;&nbsp;&nbsp;
                                                        <input type="text" class=" text-line" maxlength="3" onkeypress='return validateCompletes(event);' ng-readonly="!properties.numberOfCompletes || !data.selected" ng-model="data.per" ng-keyup="quotaPerChange(data.id, deviceInfo, dvcQuotaFlag.dvcFlxValue, 'devcSw')">%
                                                    </td>
                                                    <td class="td-th-class" ng-hide="deviceGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true" >
                                                    </td>
                                                    <td class="td-th-class" ng-hide="deviceGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true">
                                                    </td>
                                                    <td class="td-th-class" ng-if="liveSurveyEditingStep == 'editStep1' && !deviceGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved"  ng-readonly="true">
                                                    </td>
                                                </tr>

                                                <!-- With Grouping -->
                                                <tr ng-repeat="data in groupingDeviceModel" ng-if = "data.selected == true && isGrouped('device')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': deviceGrouping.check == true? deviceGrouping.check : deviceGrouping.check = false}" ng-click="data.setGrupActive = (deviceGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                    <td class="td-th-class" ng-hide="data.condditionGroup && deviceGrouping.check">
                                                        <br>
                                                        <i class="fa fa-chain-broken" aria-hidden="true"
                                                        ng-click="ungroupedConditionGrouping( 'device', data)" ng-show="data.condditionGroup" style="cursor: pointer; font-size: 20px;"></i>
                                                        {{data.name}} &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;
                                                    </td>
                                                    <td class="td-th-class" ng-hide="deviceGrouping.check || data.condditionGroup && deviceGrouping.check">
                                                        <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id, groupingDeviceModel, dvcQuotaFlag.dvcFlxValue, 'devcSw')" ng-keypress="clearNumberChange(groupingDeviceModel,$index)" ng-class="{'hoverTr-Text':trhovering}">&nbsp;&nbsp;&nbsp;
                                                        <input type="text" class=" text-line" maxlength="3" onkeypress='return validateCompletes(event);' ng-readonly="!properties.numberOfCompletes || !data.selected" ng-model="data.per" ng-keyup="quotaPerChange(data.id, groupingDeviceModel, dvcQuotaFlag.dvcFlxValue, 'devcSw')" ng-class="{'hoverTr-Text':trhovering}">%
                                                    </td>
                                                    <td class="td-th-class" ng-hide="deviceGrouping.check || data.condditionGroup && deviceGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                    <td class="td-th-class" ng-hide="deviceGrouping.check || data.condditionGroup && deviceGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                    <td class="td-th-class" ng-if="liveSurveyEditingStep == 'editStep1' && !deviceGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xs-12 text-center">
                                    <div class="center-block">
                                        <p><b>Total Remaining</b></p>
                                        <p><b>
                                                <span ng-if="quotaTotalRemRace == null || quotaTotalRemRace == undefined">
                                                        {{completesNeeded | number:0}}
                                                </span>
                                                <span>{{quotaTotalRemRace | number:0}}</span>
                                            </b>
                                        </p>
                                    </div>
                                    <span ng-repeat="option in deviceInfo track by $index">
                                        <span ng-show="$last">
                                            <button class="btn btn-primary addQuotas-btn" ng-click="deviceQuota(dvcQuotaFlag.dvcFlxValue, $event)" ng-disabled="quotaTotalRemRace !=0 || deviceAllocationsLessThanFielded" data-dismiss="modal" ng-class="{inactiveButton: !deviceGrouping.check}">Apply</button>
                                            <!-- <button class="btn btn-primary addQuotas-btn" ng-click="deviceQuota(dvcFlxValue.vlue, $event); addToNesting('device', deviceInfo, $event)" ng-disabled="quotaTotalRemRace !=0 || deviceAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest</button> -->
                                        </span>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                  </div>
        </div>

        <!--income modal-->
        <div id="incomeModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary"  data-dismiss="modal" ng-click="commonResetModal($event, incomeTempArr, incomeQuotaFlag.resetInc, incomeTotalRemRace, 'houseHoldIncome')"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                            <div class="clearfix"></div>
                        </div>
                        <div ng-if="properties.numberOfCompletes && !houseHoldIncome.max && !houseHoldIncome.min">
                            <p class="alert alert-warning text-center"> Please specify min and max income before setting quotas. </p>
                        </div>
                        <div class="row ">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                               <h2 class="text-center">Quotas for Income:</h2>
                               <p class="text-center" ng-show="isNested('houseHoldIncome')">Applying a layered quota will clear this qualification from your auto-nested quotas, causing them to recalculate.  Please verify the auto-nested quotas modal before selecting suppliers.</p>
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                <span>
                                    <label class="status pull-middle quota-flex-btn">
                                        <input type="checkbox" name="my-checkbox" checked id="inc"  ng-click="setIncomeFlex($event, incomeTempArr, incomeQuotaFlag.incomeFlxValue)" ng-model="incomeQuotaFlag.incFlx">
                                        <div class="slider round income"></div>
                                    </label>&nbsp; &nbsp; by &nbsp; &nbsp; 
                                    <input type="text" class="text-line disabled-state" maxlength="2"  onkeypress="return validateCompletes(event)" ng-model="incomeQuotaFlag.incomeFlxValue" ng-keyup="incomePercentageChange(incomeTempArr, incomeQuotaFlag.incomeFlxValue)" ng-readonly="!properties.numberOfCompletes || !incomeQuotaFlag.incFlx">
                                    <span>%</span>
                                </span>
                            </div>
                        </div>
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                                    <div class="panel">
                                        <div class="panel-heading">
                                        </div>
                                        <div class="panel-body">
                                            <div class="table-responsive">
                                                <table class="table" id="incomeform">
                                                    <thead>
                                                    <tr>
                                                        <th>INCOME RANGE ({{houseHoldIncome.units | rangeCharUnit}}{{houseHoldIncome.min}} to {{houseHoldIncome.units | rangeCharUnit}}{{houseHoldIncome.max}} )</th>
                                                        <th># OF {{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}} (0 to {{completesNeeded | number:0}})</th>
                                                        <!-- <th>FLEXIBLE</th> -->
                                                        <th>MIN</th>
                                                        <th>MAX</th>
                                                        <th ng-if="liveSurveyEditingStep == 'editStep1'">FIELDED</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                       <tr ng-repeat="data in incomeTempArr" income-row=""></tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 text-center">
                                <div class="center-block">
                                    <p><b>Total Remaining</b></p>
                                    <p><b>
                                            <span ng-if="incomeTotalRemRace == null || incomeTotalRemRace == undefined">
                                                    {{completesNeeded | number:0}}
                                                </span>
                                                <span>{{incomeTotalRemRace | number:0}}</span>
                                        </b>
                                    </p>
                                </div>
                                <span>
                                    <span>
                                        <button class="btn btn-primary addQuotas-btn" ng-click="incomeQuota($event)" ng-disabled="incomeTotalRemRace !=0 || incomeAllocationsLessThanFielded" data-dismiss="modal">Apply</button>
                                        <button class="btn btn-primary addQuotas-btn" ng-click="incomeQuota($event); addToNesting('houseHoldIncome', incomeTempArr, $event)" ng-disabled="incomeTotalRemRace !=0 || incomeAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest</button>
                                    </span>
                                </span>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <!--age modal-->
        <div id="ageModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">   
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click="commonResetModal($event, ageTempArr, ageQuotaFlag.resetAge, ageTotalRemRace,'age')"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                            <div class="clearfix"></div>
                        </div>                         
                        <div ng-if="properties.numberOfCompletes && !ageData.max && !ageData.min">
                            <p class="alert alert-warning text-center"> Please specify min and max age before setting quotas. </p>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                               <h2 class="text-center">Quotas for Age:</h2>
                               <!-- <p class="text-center" ng-show="isNested('age')">Applying a layered quota will clear this qualification from your auto-nested quotas, causing them to recalculate.  Please verify the auto-nested quotas modal before selecting suppliers.</p> -->
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                <span><label class="status pull-middle quota-flex-btn"><input type="checkbox" name="my-checkbox" checked id="age"  ng-click="setAgeFlex($event, ageTempArr, ageQuotaFlag.ageFlxValue)" ng-model="ageQuotaFlag.ageFlx"><div class="slider round incomer"></div></label>&nbsp; &nbsp; by &nbsp; &nbsp;<input type="text" class="text-line disabled-state" maxlength="2"  onkeypress="return validateQty(event)" ng-model="ageQuotaFlag.ageFlxValue" ng-keyup="agePercentageChange(ageTempArr, ageQuotaFlag.ageFlxValue)" ng-readonly="!properties.numberOfCompletes || !ageQuotaFlag.ageFlx"><span>%</span>
                                </span>
                            </div>
                        </div>
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                                    <div class="panel">
                                        <div class="panel-heading">
                                        </div>
                                        <div class="panel-body">
                                            <div class="table-responsive">
                                                <table class="table" id="POITable">
                                                    <thead>
                                                    <tr >
                                                        <th>AGE ({{ageData.min}} to {{ageData.max}})</th>
                                                        <th># OF {{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}} (0 to {{completesNeeded | number:0}})</th>
                                                        <!-- <th>FLEXIBLE</th> -->
                                                        <th>MIN</th>
                                                        <th>MAX</th>
                                                        <th ng-if="liveSurveyEditingStep == 'editStep1'">FIELDED</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr ng-repeat="data in ageTempArr" age-row="">
                                                            
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 text-center">
                                <div class="center-block">
                                    <p><b>Total Remaining</b></p>
                                    <p><b>
                                            <span ng-if="ageTotalRemRace == null || ageTotalRemRace == undefined">
                                                    {{completesNeeded | number:0}}
                                                </span>
                                                <span>{{ageTotalRemRace | number:0}}</span>
                                        </b>
                                    </p>
                                </div>
                                <span ng-repeat="option in ageTempArr track by $index">
                                    <span ng-show="$last">
                                        <button class="btn btn-primary addQuotas-btn" ng-click="ageQuota($event)" ng-disabled="ageTotalRemRace !=0 || ageAllocationsLessThanFielded" data-dismiss="modal">Apply</button>
                                        <button class="btn btn-primary addQuotas-btn" ng-click="ageQuota($event); addToNesting('age', ageTempArr, $event)" ng-disabled="ageTotalRemRace !=0 || ageAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest</button>
                                    </span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--gender modal-->
        <div id="genderModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <!-- <button class="btn btn-secondary" data-dismiss="modal" ng-click ="commonResetModal(element, genderInfo, gndrQuotaFlag.resetGen, quotaTotalRemRace, 'gender')"><img class="img-responsive" src="img/modal-close.png" alt="close button" /></button> -->
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click ="commonResetModal(element, genderInfo, gndrQuotaFlag.resetGen, quotaTotalRemRace, 'gender')">
                                <i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span>
                            </button>
                            <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3">
                                <h2 class="text-center">Quotas for Gender:</h2>
                                <p class="text-center" ng-show="isNested('gender')">Applying a layered quota will clear this qualification from your auto-nested quotas, causing them to recalculate.  Please verify the auto-nested quotas modal before selecting suppliers.</p>
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                <span><label class="status pull-middle quota-flex-btn"><input type="checkbox" checked id="gndr"  ng-click ="setGenderFlex($event, genderInfo, gndrQuotaFlag.gndrFlxValue)" ng-model="gndrQuotaFlag.gndrFlx"><div class="slider round genderr"></div></label>&nbsp; &nbsp; by &nbsp; &nbsp;
                                <input type="text" class="text-line disabled-state" maxlength="2"  onkeypress='return validateQty(event);' ng-model="gndrQuotaFlag.gndrFlxValue" ng-keyup="quotaPercentageChange(genderInfo, gndrQuotaFlag.gndrFlxValue)" ng-readonly="!properties.numberOfCompletes || !gndrQuotaFlag.gndrFlx"><span>%</span>
                                </span>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <table class="table" id="genderform">
                                            <thead>
                                            <tr >
                                                <th></th>
                                                <th>{{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                                <th>MIN</th>
                                                <th>MAX</th>
                                                <th ng-if="liveSurveyEditingStep == 'editStep1'">FIELDED</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr ng-repeat="data in genderInfo"  ng-if="data.selected == true">
                                                <td class="td-th-class">
                                                    <br>
                                                    {{data.name}} &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;
                                                </td>
                                                <td class="td-th-class">
                                                    <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-keyup="quotaNumberChange(data.id, genderInfo , gndrQuotaFlag.gndrFlxValue, 'gndr')" ng-keypress="clearNumberChange(genderInfo,$index)">&nbsp;&nbsp;&nbsp;
                                                    <input type="text" class=" text-line" maxlength="3" onkeypress='return validateCompletes(event);' ng-model="data.per" ng-keyup="quotaPerChange(data.id, genderInfo , gndrQuotaFlag.gndrFlxValue, 'gndr')">%
                                                </td>
                                                <td class="td-th-class">
                                                    <input type="number" class="text-line" onkeypress='return validateQty(event);'  ng-model="data.minimum"  ng-readonly="true">
                                                </td>
                                                <td class="td-th-class">
                                                    <input type="number" class="text-line" onkeypress='return validateQty(event);'  ng-model="data.maximum"  ng-readonly="true">
                                                </td>
                                                <td class="td-th-class" ng-if="liveSurveyEditingStep == 'editStep1'">
                                                    <input type="number" class="text-line" onkeypress='return validateQty(event);'  ng-model="data.achieved"  ng-readonly="true">
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 text-center" >
                                <div class="center-block">
                                    <p><b>Total Remaining</b></p>
                                    <p><b>
                                            <span ng-if="quotaTotalRemRace == null || quotaTotalRemRace == undefined">
                                                    {{completesNeeded | number:0}}
                                                </span>
                                                <span>{{quotaTotalRemRace | number:0}}</span>
                                        </b>
                                    </p>
                                </div>
                                <span ng-repeat="option in genderInfo track by $index">
                                    <span ng-show="$last">
                                        <button class="btn btn-primary addQuotas-btn" ng-click="genderQuota(gndrQuotaFlag.gndrFlxValue, $event)" ng-disabled="quotaTotalRemRace !=0 || gndrAllocationsLessThanFielded" data-dismiss="modal">Apply</button>
                                        <button class="btn btn-primary addQuotas-btn" ng-click="genderQuota(gndrQuotaFlag.gndrFlxValue, $event); addToNesting('gender', genderInfo, $event);" ng-disabled="quotaTotalRemRace !=0 || gndrAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest</button>
                                    </span>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
              </div>
        </div>

        <!--Census Region modal-->

        <div id="censusRegionModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                <div class="feasibility-header">
                    <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click ="commonResetModal($event, region, regQuotaFlag.resetReg, quotaTotalRemRace, 'regions')"><i class="fa fa-times" aria-hidden="true"></i><span class="key_label">esc</span></button>
                    <div class="clearfix"></div>
                </div>
                <div class="row">
                    <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                        <h2 class="text-center">Quotas for Census Region:</h2>
                        <p class="text-center" ng-show="isNested('regions')">Applying a layered quota will clear this qualification from your auto-nested quotas, causing them to recalculate.  Please verify the auto-nested quotas modal before selecting suppliers.</p>
                    </div>
                    <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                        <p>FLEXIBLE</p>
                        <span>
                            <label class="status pull-middle quota-flex-btn">
                                <input type="checkbox" id="regionSw" ng-model="regQuotaFlag.regionFlx"  ng-click ="setRegionFlex($event, region, regQuotaFlag.regionFlxValue)" checked>
                                <div class="slider round racer"></div>
                            </label>&nbsp; &nbsp; by &nbsp; &nbsp; <input type="text" class="text-line disabled-state" maxlength="2"  onkeypress='return validateQty(event);' ng-model="regQuotaFlag.regionFlxValue" ng-readonly="!properties.numberOfCompletes || !dvsnQuotaFlag.divisionFlx"  ng-keyup="quotaPercentageChange(region, regQuotaFlag.regionFlxValue); groupingUpdateFleaxibility('regions', groupingCensusRgnModel, regQuotaFlag.regionFlxValue)"><span>%</span>
                        </span>
                    </div>

                    <!-- PD-1402 -->

                    <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3 text-center" ><br/>
                        <button class="btn btn-primary btn-md grupCondtion submit-btn" type="button" ng-click="censusRegnGrouping.check = !censusRegnGrouping.check" ng-hide="censusRegnGrouping.check">Group Conditions</button>
                        <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="selectedQuotaGrouping('regions',region); censusRegnGrouping.check = !censusRegnGrouping.check" ng-show="censusRegnGrouping.check">Group</button>
                        <!-- &nbsp; &nbsp; &nbsp; &nbsp; -->
                        <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="censusRegnGrouping.check = !censusRegnGrouping.check; removeSelectedQualOnCancel(region,'regions')" ng-show="censusRegnGrouping.check">Cancel</button>
                    </div>
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                    <div class="panel">
                        <div class="panel-body">
                            <div class="table-responsive">
                                <table class="table" id="censusform">
                                    <thead>
                                    <tr>
                                        <th></th>
                                        <th ng-hide="censusRegnGrouping.check">{{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                        <th ng-hide="censusRegnGrouping.check">MIN</th>
                                        <th ng-hide="censusRegnGrouping.check">MAX</th>
                                        <th ng-if="liveSurveyEditingStep == 'editStep1' && !censusRegnGrouping.check">FIELDED</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr ng-repeat="data in region" ng-if="data.selected == true && !isGrouped('regions')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': censusRegnGrouping.check == true? censusRegnGrouping.check : censusRegnGrouping.check = false}" ng-click="data.setGrupActive = (censusRegnGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                        <td class="td-th-class" >
                                            <br>
                                            <label>
                                                {{ data.name }}
                                            </label>
                                        </td>
                                        <td class="td-th-class" ng-hide="censusRegnGrouping.check">
                                            <input type="number" class=" text-line" onkeypress='return validateCompletes(event);'  ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id ,region, regQuotaFlag.regionFlxValue, 'regionSw')" ng-keypress="clearNumberChange(region,$index)">&nbsp;&nbsp;&nbsp;
                                            <input type="text" class=" text-line"  maxlength="2" onkeypress='return validateQty(event);' ng-model="data.per" ng-keyup="quotaPerChange(data.id, region, regQuotaFlag.regionFlxValue, 'regionSw')">%
                                        </td>
                                        <td class="td-th-class" ng-hide="censusRegnGrouping.check">
                                            <input type="number" class="text-line" onkeypress='return validateQty(event);'  ng-model="data.minimum"  ng-readonly="true">
                                        </td>
                                        <td class="td-th-class" ng-hide="censusRegnGrouping.check">
                                            <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum" ng-readonly="true">
                                        </td>
                                        <td class="td-th-class" ng-if="liveSurveyEditingStep == 'editStep1' && !censusRegnGrouping.check">
                                            <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved" ng-readonly="true">
                                        </td>
                                    </tr>
                                    <!-- With Grouping -->
                                    <tr ng-repeat="data in groupingCensusRgnModel" ng-if="data.selected == true && isGrouped('regions')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': censusRegnGrouping.check == true? censusRegnGrouping.check : censusRegnGrouping.check = false}" ng-click="data.setGrupActive = (censusRegnGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                        <td class="td-th-class" ng-hide="data.condditionGroup && censusRegnGrouping.check">
                                            <br>
                                            <i class="fa fa-chain-broken" aria-hidden="true" ng-click="ungroupedConditionGrouping( 'regions', data)" ng-show="data.condditionGroup" style="cursor: pointer; font-size: 20px;"></i>
                                            <label>
                                                {{ data.name }}
                                            </label>
                                        </td>
                                        <td class="td-th-class" ng-hide="censusRegnGrouping.check || data.condditionGroup && censusRegnGrouping.check">
                                            <input type="number" class=" text-line" onkeypress='return validateCompletes(event);'  ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id ,groupingCensusRgnModel, regQuotaFlag.regionFlxValue, 'regionSw')" ng-keypress="clearNumberChange(groupingCensusRgnModel,$index)" ng-class="{'hoverTr-Text':trhovering}">&nbsp;&nbsp;&nbsp;
                                            <input type="text" class=" text-line"  maxlength="2" onkeypress='return validateQty(event);' ng-model="data.per" ng-keyup="quotaPerChange(data.id, groupingCensusRgnModel, regQuotaFlag.regionFlxValue, 'regionSw')" ng-class="{'hoverTr-Text':trhovering}">%
                                        </td>
                                        <td class="td-th-class" ng-hide="censusRegnGrouping.check || data.condditionGroup && censusRegnGrouping.check">
                                            <input type="number" class="text-line" onkeypress='return validateQty(event);'  ng-model="data.minimum"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                        </td>
                                        <td class="td-th-class" ng-hide="censusRegnGrouping.check || data.condditionGroup && censusRegnGrouping.check">
                                            <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum" ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                        </td>
                                        <td class="td-th-class" ng-if="liveSurveyEditingStep == 'editStep1' && !censusRegnGrouping.check">
                                            <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved" ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 text-center">
                        <div class="center-block">
                            <p><b>Total Remaining</b></p>
                            <p><b>
                                    <span ng-if="quotaTotalRemRace == null || quotaTotalRemRace == undefined">
                                        {{completesNeeded - locationData.achieved | number:0}}
                                    </span>
                                    <span >{{quotaTotalRemRace - locationData.achieved + currLocQuotaFielded | number:0}}</span>
                                </b>
                            </p>
                        </div>
                        <button class="btn btn-primary addQuotas-btn" ng-click="addRegionQuota(regQuotaFlag.regionFlxValue, $event)" ng-disabled="(quotaTotalRemRace - locationData.achieved + currLocQuotaFielded) !=0 || rgnAllocationsLessThanFielded" data-dismiss="modal" ng-class="{inactiveButton: !censusRegnGrouping.check}">Apply</button>
                         <button class="btn btn-primary addQuotas-btn" ng-click="addRegionQuota(regQuotaFlag.regionFlxValue, $event); addToNesting('regions', conditionGroupingArray.regions?conditionGroupingArray.regions:region, $event)" ng-disabled="(quotaTotalRemRace - locationData.achieved + currLocQuotaFielded) !=0 || rgnAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest </button>
                    </div>
                </div>
                    </div>
                </div>
            </div>
        </div>

        <!--Census Division modal-->

        <div id="censusDivisionModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click ="commonResetModal($event, division, dvsnQuotaFlag.resetDivi, quotaTotalRemRace, 'divisions')"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                            <div class="clearfix"></div>
                        </div>     
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                                <h2 class="text-center">Quotas for Census Division:</h2>
                                <p class="text-center" ng-show="isNested('divisions')">Applying a layered quota will clear this qualification from your auto-nested quotas, causing them to recalculate.  Please verify the auto-nested quotas modal before selecting suppliers.</p>
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                <span>
                                    <label class="status pull-middle quota-flex-btn">
                                        <input type="checkbox" id="divisionSw" ng-model="dvsnQuotaFlag.divisionFlx"  ng-click ="setDivisionFlex($event, division, dvsnQuotaFlag.divisionFlxValue)" checked>
                                        <div class="slider round racer"></div>
                                    </label>&nbsp; &nbsp; by &nbsp; &nbsp;
                                    <input type="text" class="text-line" maxlength="2"  onkeypress='return validateQty(event);' ng-model="dvsnQuotaFlag.divisionFlxValue" ng-readonly="!properties.numberOfCompletes || !dvsnQuotaFlag.divisionFlx"  ng-keyup="quotaPercentageChange(division, dvsnQuotaFlag.divisionFlxValue); groupingUpdateFleaxibility('divisions', groupingDivisionModel, dvsnQuotaFlag.divisionFlxValue)">
                                    <span>%</span>
                                </span>
                            </div>
                            <!-- PD-1402 -->

                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3 text-center" ><br/>
                                <button class="btn btn-primary btn-md grupCondtion submit-btn" type="button" ng-click="devisionGrouping.check = !devisionGrouping.check" ng-hide="devisionGrouping.check">Group Conditions</button>
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="selectedQuotaGrouping('divisions',division); devisionGrouping.check = !devisionGrouping.check" ng-show="devisionGrouping.check">Group</button>
                                <!-- &nbsp; &nbsp; &nbsp; &nbsp; -->
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="devisionGrouping.check = !devisionGrouping.check; removeSelectedQualOnCancel(division,'divisions')" ng-show="devisionGrouping.check">Cancel</button>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <table class="table" id="divisionform">
                                            <thead>
                                            <tr>
                                                <th></th>
                                                <th ng-hide="devisionGrouping.check">{{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                                <th ng-hide="devisionGrouping.check">MIN</th>
                                                <th ng-hide="devisionGrouping.check">MAX</th>
                                                <th ng-if="liveSurveyEditingStep == 'editStep1' && !devisionGrouping.check">FIELDED</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr ng-repeat="data in division" ng-if="data.selected == true && !isGrouped('divisions')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': devisionGrouping.check == true? devisionGrouping.check : devisionGrouping.check = false}" ng-click="data.setGrupActive = (devisionGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                <td class="td-th-class" >
                                                    <br>
                                                    <label>
                                                        {{data.name}}
                                                    </label>
                                                </td>
                                                <td class="td-th-class" ng-hide="devisionGrouping.check">
                                                    <input type="number" class=" text-line" onkeypress='return validateCompletes(event);'  ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id, division, dvsnQuotaFlag.divisionFlxValue, 'divisionSw')" ng-keypress="clearNumberChange(division,$index)">&nbsp;&nbsp;&nbsp;
                                                    <input type="text" class=" text-line"  maxlength="2" onkeypress='return validateQty(event);' ng-model="data.per" ng-keyup="quotaPerChange(data.id, division, dvsnQuotaFlag.divisionFlxValue, 'divisionSw')">%
                                                </td>
                                                <td class="td-th-class" ng-hide="devisionGrouping.check">
                                                    <input type="number" class="text-line" onkeypress='return validateQty(event);'  ng-model="data.minimum"  ng-readonly="true">
                                                </td>
                                                <td class="td-th-class" ng-hide="devisionGrouping.check">
                                                    <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum" ng-readonly="true">
                                                </td>
                                                <td class="td-th-class" ng-if="liveSurveyEditingStep == 'editStep1' && !devisionGrouping.check">
                                                    <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved" ng-readonly="true">
                                                </td>
                                            </tr>

                                            <!-- With Grouping -->
                                            <tr ng-repeat="data in groupingDivisionModel" ng-if="data.selected == true && isGrouped('divisions')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': devisionGrouping.check == true? devisionGrouping.check : devisionGrouping.check = false}" ng-click="data.setGrupActive = (devisionGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                <td class="td-th-class" ng-hide="data.condditionGroup && devisionGrouping.check">
                                                    <br>
                                                    <i class="fa fa-chain-broken" aria-hidden="true" ng-click="ungroupedConditionGrouping( 'divisions', data)" ng-show="data.condditionGroup" style="cursor: pointer; font-size: 20px;"></i>
                                                    <label>
                                                        {{data.name}}
                                                    </label>
                                                </td>
                                                <td class="td-th-class" ng-hide="devisionGrouping.check || data.condditionGroup && devisionGrouping.check">
                                                    <input type="number" class=" text-line" onkeypress='return validateCompletes(event);'  ng-model="data.number" ng-readonly="!properties.numberOfCompletes || !data.selected" ng-keyup="quotaNumberChange(data.id, groupingDivisionModel, dvsnQuotaFlag.divisionFlxValue, 'divisionSw')" ng-keypress="clearNumberChange(groupingDivisionModel,$index)" ng-class="{'hoverTr-Text':trhovering}">&nbsp;&nbsp;&nbsp;
                                                    <input type="text" class=" text-line"  maxlength="2" onkeypress='return validateQty(event);' ng-model="data.per" ng-keyup="quotaPerChange(data.id, groupingDivisionModel, dvsnQuotaFlag.divisionFlxValue, 'divisionSw')" ng-class="{'hoverTr-Text':trhovering}">%
                                                </td>
                                                <td class="td-th-class" ng-hide="devisionGrouping.check || data.condditionGroup && devisionGrouping.check">
                                                    <input type="number" class="text-line" onkeypress='return validateQty(event);'  ng-model="data.minimum"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                </td>
                                                <td class="td-th-class" ng-hide="devisionGrouping.check || data.condditionGroup && devisionGrouping.check">
                                                    <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum" ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                </td>
                                                <td class="td-th-class" ng-if="liveSurveyEditingStep == 'editStep1' && !devisionGrouping.check">
                                                    <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved" ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 text-center">
                                <div class="center-block">
                                    <p><b>Total Remaining</b></p>
                                    <p><b>
                                            <span ng-if="quotaTotalRemRace == null || quotaTotalRemRace == undefined">
                                                {{completesNeeded - locationData.achieved | number:0}}
                                            </span>
                                            <span>{{quotaTotalRemRace - locationData.achieved + currLocQuotaFielded | number:0}}</span>
                                        </b>
                                    </p>
                                </div>
                                <button class="btn btn-primary addQuotas-btn" ng-click="addDivisionQuota(dvsnQuotaFlag.divisionFlxValue, $event)" ng-disabled="(quotaTotalRemRace - locationData.achieved +currLocQuotaFielded) !=0 || dvsnAllocationsLessThanFielded" data-dismiss="modal"  ng-class="{inactiveButton: !devisionGrouping.check}">Apply</button>
                                <button class="btn btn-primary addQuotas-btn" ng-click="addDivisionQuota(dvsnQuotaFlag.divisionFlxValue, $event); addToNesting('divisions', conditionGroupingArray.divisions?conditionGroupingArray.divisions:division, $event)" ng-disabled="(quotaTotalRemRace - locationData.achieved +currLocQuotaFielded) !=0 || dvsnAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--State modal-->
        <div id="stateModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click="stateQuotaResetModal()"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                                <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                                <h2 class="text-center">Quotas for {{locationViews.state.name}}:</h2>
                                <p class="text-center" ng-show="isNested('states')">Applying a layered quota will clear this qualification from your auto-nested quotas, causing them to recalculate.  Please verify the auto-nested quotas modal before selecting suppliers.</p>
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                <span>
                                    <label class="status pull-middle quota-flex-btn">
                                    <input type="checkbox" id="stateSw" ng-model="stateFlexibility.isFlexible"  ng-click ="setStateFlex($event, selectedStates, stateFlexibility.flxValue)">
                                    <div class="slider round relationr"></div>
                                    </label>&nbsp; &nbsp; by &nbsp; &nbsp; 
                                    <input type="number" class="text-line disabled-state" maxlength="2"  onkeypress='return validateQty(event);' ng-model="stateFlexibility.flxValue" ng-hide ="flexible == false" ng-keyup="quotaPercentageChange(selectedStates, stateFlexibility.flxValue); groupingUpdateFleaxibility('states', groupingStateModel, stateFlexibility.flxValue)" ng-readonly="!properties.numberOfCompletes || !stateFlexibility.isFlexible" >
                                    <span>%</span>
                                </span>
                            </div>
                            <!-- PD-1402 -->

                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3 text-center" ><br/>
                                <button class="btn btn-primary btn-md grupCondtion submit-btn" type="button" ng-click="stateGrouping.check = !stateGrouping.check" ng-hide="stateGrouping.check">Group Conditions</button>
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="selectedQuotaGrouping('states',selectedStates); stateGrouping.check = !stateGrouping.check" ng-show="stateGrouping.check">Group</button>
                                <!-- &nbsp; &nbsp; &nbsp; &nbsp; -->
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="stateGrouping.check = !stateGrouping.check; removeSelectedQualOnCancel(selectedStates,'states')" ng-show="stateGrouping.check">Cancel</button>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <table class="table" id="rlnform">
                                            <thead>
                                            <tr >
                                                <th></th>
                                                <th ng-hide="stateGrouping.check">{{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                                <th ng-hide="stateGrouping.check">MIN</th>
                                                <th ng-hide="stateGrouping.check">MAX</th>
                                                <th ng-if="liveSurveyEditingStep == 'editStep1' && !stateGrouping.check">FIELDED</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="data in selectedStates" ng-if="!isGrouped('states')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': stateGrouping.check == true? stateGrouping.check : stateGrouping.check = false}" ng-click="data.setGrupActive = (stateGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                    <td >
                                                        <br>
                                                        <label>
                                                            {{data.name}}
                                                        </label>

                                                    </td>
                                                    <td ng-hide="stateGrouping.check">
                                                        <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes" ng-keyup="quotaNumberChange(data.id, selectedStates, stateFlexibility.flxValue,'stateSw')" >&nbsp;&nbsp;&nbsp;
                                                        <input type="number" class=" text-line" maxlength="3" onkeypress='return validateQty(event);' ng-model="data.per" ng-keyup="quotaPerChange(data.id, selectedStates, stateFlexibility.flxValue, 'stateSw')">%
                                                    </td>
                                                    <td ng-hide="stateGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true">
                                                    </td>
                                                    <td ng-hide="stateGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true">
                                                    </td>
                                                    <td ng-if="liveSurveyEditingStep == 'editStep1' && !stateGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved"  ng-readonly="true">
                                                    </td>
                                                </tr>
                                                <!-- With Grouping -->
                                                <tr ng-repeat="data in groupingStateModel" ng-if="isGrouped('states')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': stateGrouping.check == true? stateGrouping.check : stateGrouping.check = false}" ng-click="data.setGrupActive = (stateGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                    <td ng-hide="data.condditionGroup && stateGrouping.check">
                                                    <br>
                                                    <i class="fa fa-chain-broken" aria-hidden="true" ng-click="ungroupedConditionGrouping( 'states', data)" ng-show="data.condditionGroup" style="cursor: pointer; font-size: 20px;"></i>
                                                        <label>
                                                            {{data.name}}
                                                        </label>

                                                    </td>
                                                    <td ng-hide="stateGrouping.check || data.condditionGroup && stateGrouping.check">
                                                        <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes" ng-keyup="quotaNumberChange(data.id, groupingStateModel, stateFlexibility.flxValue,'stateSw')" ng-class="{'hoverTr-Text':trhovering}">&nbsp;&nbsp;&nbsp;
                                                        <input type="number" class=" text-line" maxlength="3" onkeypress='return validateQty(event);' ng-model="data.per" ng-keyup="quotaPerChange(data.id, groupingStateModel, stateFlexibility.flxValue, 'stateSw')" ng-class="{'hoverTr-Text':trhovering}">%
                                                    </td>
                                                    <td ng-hide="stateGrouping.check || data.condditionGroup && stateGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                    <td ng-hide="stateGrouping.check || data.condditionGroup && stateGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                    <td ng-if="liveSurveyEditingStep == 'editStep1' && !stateGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 text-center">
                                <div class="center-block">
                                        <p><b>Total Remaining</b></p>
                                        <p><b>
                                                <!--<span ng-repeat="option in race track by $index">
                                                    <span ng-show="$last">{{option.totalRem || 0}}</span>
                                                </span>-->
                                                <span ng-if="quotaTotalRemRace == null || quotaTotalRemRace == undefined">
                                                    {{completesNeeded - locationData.achieved | number:0}}
                                                </span>
                                                <span>{{quotaTotalRemRace - locationData.achieved+currLocQuotaFielded | number:0}}</span>
                                            </b>
                                        </p>
                                </div>
                                <button class="btn btn-primary addQuotas-btn" ng-click="addStateQuota($event)" ng-disabled="(quotaTotalRemRace - locationData.achieved + currLocQuotaFielded) !=0 || stateAllocationsLessThanFielded" data-dismiss="modal" ng-class="{inactiveButton: !stateGrouping.check}">Apply</button>
                                <button class="btn btn-primary addQuotas-btn" ng-click="addStateQuota($event); addToNesting('states', conditionGroupingArray.states?conditionGroupingArray.states:selectedStates, $event)" ng-disabled="(quotaTotalRemRace - locationData.achieved + currLocQuotaFielded) !=0 || stateAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--DMA quota modal-->
        <div id="dmaQuotaModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click="dmaQuotaResetModal()"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                                <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                                <h2 class="text-center">Quotas for {{locationViews.dma.name}}:</h2>
                                <p class="text-center" ng-show="isNested('dma')">Applying a layered quota will clear this qualification from your auto-nested quotas, causing them to recalculate.  Please verify the auto-nested quotas modal before selecting suppliers.</p>
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                <span>
                                    <label class="status pull-middle quota-flex-btn">
                                    <input type="checkbox" id="dmaSw" ng-model="dmaFlexibility.isFlexible" ng-click="setDmaFlex($event, selectedDMAs, dmaFlexibility.flxValue)">
                                    <div class="slider round relationr"></div>
                                    </label>&nbsp; &nbsp; by &nbsp; &nbsp; 
                                    <input type="number" class="text-line disabled-state" maxlength="2"  onkeypress='return validateQty(event);' ng-model="dmaFlexibility.flxValue" ng-hide ="flexible == false" ng-keyup="quotaPercentageChange(selectedDMAs, dmaFlexibility.flxValue); groupingUpdateFleaxibility('dma', groupingDmaModel, dmaFlexibility.flxValue)" ng-readonly="!properties.numberOfCompletes || !dmaFlexibility.isFlexible" >
                                    <span>%</span>
                                </span>
                            </div>
                            <!-- PD-1402 -->

                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3 text-center" ><br/>
                                <button class="btn btn-primary btn-md grupCondtion submit-btn" type="button" ng-click="dmaGrouping.check = !dmaGrouping.check" ng-hide="dmaGrouping.check">Group Conditions</button>
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="selectedQuotaGrouping('dma',selectedDMAs); dmaGrouping.check = !dmaGrouping.check" ng-show="dmaGrouping.check">Group</button>
                                <!-- &nbsp; &nbsp; &nbsp; &nbsp; -->
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="dmaGrouping.check = !dmaGrouping.check; removeSelectedQualOnCancel(selectedDMAs,'dma')" ng-show="dmaGrouping.check">Cancel</button>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <table class="table" id="rlnform">
                                            <thead>
                                            <tr >
                                                <th></th>
                                                <th ng-hide="dmaGrouping.check">{{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                                <th ng-hide="dmaGrouping.check">MIN</th>
                                                <th ng-hide="dmaGrouping.check">MAX</th>
                                                <th ng-if="liveSurveyEditingStep == 'editStep1' && !dmaGrouping.check">FIELDED</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="data in selectedDMAs" ng-if="!isGrouped('dma')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': dmaGrouping.check == true? dmaGrouping.check : dmaGrouping.check = false}" ng-click="data.setGrupActive = (dmaGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                    <td >
                                                        <br>
                                                        <label>
                                                            {{data.name}}
                                                        </label>

                                                    </td>
                                                    <td ng-hide="dmaGrouping.check">
                                                        <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes" ng-keyup="quotaNumberChange(data.id, selectedDMAs, dmaFlexibility.flxValue,'dmaSw')" >&nbsp;&nbsp;&nbsp;
                                                        <input type="number" class=" text-line" maxlength="3" onkeypress='return validateQty(event);' ng-model="data.per" ng-keyup="quotaPerChange(data.id, selectedDMAs, dmaFlexibility.flxValue, 'dmaSw')">%
                                                    </td>
                                                    <td ng-hide="dmaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true">
                                                    </td>
                                                    <td ng-hide="dmaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true">
                                                    </td>
                                                    <td ng-if="liveSurveyEditingStep == 'editStep1' && !dmaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved"  ng-readonly="true">
                                                    </td>
                                                </tr>
                                                <!-- With Grouping -->
                                                <tr ng-repeat="data in groupingDmaModel" ng-if="isGrouped('dma')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': dmaGrouping.check == true? dmaGrouping.check : dmaGrouping.check = false}" ng-click="data.setGrupActive = (dmaGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                    <td ng-hide="data.condditionGroup && dmaGrouping.check">
                                                    <br>
                                                    <i class="fa fa-chain-broken" aria-hidden="true" ng-click="ungroupedConditionGrouping( 'dma', data)" ng-show="data.condditionGroup" style="cursor: pointer; font-size: 20px;"></i>
                                                        <label>
                                                            {{data.name}}
                                                        </label>

                                                    </td>
                                                    <td ng-hide="dmaGrouping.check || data.condditionGroup && dmaGrouping.check">
                                                        <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes" ng-keyup="quotaNumberChange(data.id, groupingDmaModel, dmaFlexibility.flxValue,'dmaSw')"  ng-class="{'hoverTr-Text':trhovering}">&nbsp;&nbsp;&nbsp;
                                                        <input type="number" class=" text-line" maxlength="3" onkeypress='return validateQty(event);' ng-model="data.per" ng-keyup="quotaPerChange(data.id, groupingDmaModel, dmaFlexibility.flxValue, 'dmaSw')" ng-class="{'hoverTr-Text':trhovering}">%
                                                    </td>
                                                    <td ng-hide="dmaGrouping.check || data.condditionGroup && dmaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                    <td ng-hide="dmaGrouping.check || data.condditionGroup && dmaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                    <td ng-if="liveSurveyEditingStep == 'editStep1' && !dmaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 text-center">
                                <div class="center-block">
                                        <p><b>Total Remaining</b></p>
                                        <p><b>
                                                <!--<span ng-repeat="option in race track by $index">
                                                    <span ng-show="$last">{{option.totalRem || 0}}</span>
                                                </span>-->
                                                <span ng-if="quotaTotalRemRace == null || quotaTotalRemRace == undefined">
                                                    {{completesNeeded -locationData.achieved | number:0}}
                                                </span>
                                                <span>{{quotaTotalRemRace - locationData.achieved + currLocQuotaFielded | number:0}}</span>
                                            </b>
                                        </p>
                                </div>
                                <button class="btn btn-primary addQuotas-btn" ng-click="addDMAQuota($event)" ng-disabled="(quotaTotalRemRace -locationData.achieved +currLocQuotaFielded) !=0 || dmaAllocationsLessThanFielded" data-dismiss="modal" ng-class="{inactiveButton: !dmaGrouping.check}">Apply</button>
                                <button class="btn btn-primary addQuotas-btn" ng-click="addDMAQuota($event); addToNesting('dma', conditionGroupingArray.dma?conditionGroupingArray.dma:selectedDMAs, $event)" ng-disabled="(quotaTotalRemRace -locationData.achieved +currLocQuotaFielded) !=0 || dmaAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- DMA quota model end -->
        <!--CSA quota modal-->
        <div id="csaQuotaModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click="csaQuotaResetModal()"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                                <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                                <h2 class="text-center">Quotas for {{locationViews.csa.name}}:</h2>
                                <p class="text-center" ng-show="isNested('csa')">Applying a layered quota will clear this qualification from your auto-nested quotas, causing them to recalculate.  Please verify the auto-nested quotas modal before selecting suppliers.</p>
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                <span>
                                    <label class="status pull-middle quota-flex-btn">
                                    <input type="checkbox" id="csaSw" ng-model="csaFlexibility.isFlexible" ng-click="setCsaFlex($event, selectedCSAs, csaFlexibility.flxValue)">
                                    <div class="slider round relationr"></div>
                                    </label>&nbsp; &nbsp; by &nbsp; &nbsp; 
                                    <input type="number" class="text-line disabled-state" maxlength="3"  onkeypress='return validateQty(event);' ng-model="csaFlexibility.flxValue" ng-hide ="flexible == false" ng-keyup="quotaPercentageChange(selectedCSAs, csaFlexibility.flxValue); groupingUpdateFleaxibility('csa', groupingCsaModel, csaFlexibility.flxValue)" ng-readonly="!properties.numberOfCompletes || !csaFlexibility.isFlexible" >
                                    <span>%</span>
                                </span>
                            </div>
                            <!-- PD-1402 -->

                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3 text-center" ><br/>
                                <button class="btn btn-primary btn-md grupCondtion submit-btn" type="button" ng-click="csaGrouping.check = !csaGrouping.check" ng-hide="csaGrouping.check">Group Conditions</button>
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="selectedQuotaGrouping('csa',selectedCSAs); csaGrouping.check = !csaGrouping.check" ng-show="csaGrouping.check">Group</button>
                                <!-- &nbsp; &nbsp; &nbsp; &nbsp; -->
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="csaGrouping.check = !csaGrouping.check; removeSelectedQualOnCancel(selectedCSAs,'csa')" ng-show="csaGrouping.check">Cancel</button>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <table class="table" id="rlnform">
                                            <thead>
                                            <tr >
                                                <th></th>
                                                <th ng-hide="csaGrouping.check">{{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                                <th ng-hide="csaGrouping.check">MIN</th>
                                                <th ng-hide="csaGrouping.check">MAX</th>
                                                <th ng-if="liveSurveyEditingStep == 'editStep1' && !csaGrouping.check">FIELDED</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="data in selectedCSAs" ng-if="!isGrouped('csa')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': csaGrouping.check == true? csaGrouping.check : csaGrouping.check = false}" ng-click="data.setGrupActive = (csaGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                    <td >
                                                        <br>
                                                        <label>
                                                            {{data.name}}
                                                        </label>

                                                    </td>
                                                    <td ng-hide="csaGrouping.check">
                                                        <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes" ng-keyup="quotaNumberChange(data, selectedCSAs, csaFlexibility.flxValue,'csaSw')" >&nbsp;&nbsp;&nbsp;
                                                        <input type="number" class=" text-line" maxlength="3" onkeypress='return validateQty(event);' ng-model="data.per" ng-keyup="quotaPerChange(data.id, selectedCSAs, csaFlexibility.flxValue, 'csaSw')">%
                                                    </td>
                                                    <td ng-hide="csaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true">
                                                    </td>
                                                    <td ng-hide="csaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true">
                                                    </td>
                                                    <td ng-if="liveSurveyEditingStep == 'editStep1' && !csaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved"  ng-readonly="true">
                                                    </td>
                                                </tr>
                                                <!-- With Grouping -->
                                                <tr ng-repeat="data in groupingCsaModel" ng-if="isGrouped('csa')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': csaGrouping.check == true? csaGrouping.check : csaGrouping.check = false}" ng-click="data.setGrupActive = (csaGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                    <td ng-hide="data.condditionGroup && csaGrouping.check">
                                                    <br>
                                                    <i class="fa fa-chain-broken" aria-hidden="true" ng-click="ungroupedConditionGrouping( 'csa', data)" ng-show="data.condditionGroup" style="cursor: pointer; font-size: 20px;"></i>
                                                        <label>
                                                            {{data.name}}
                                                        </label>

                                                    </td>
                                                    <td ng-hide="csaGrouping.check || data.condditionGroup && csaGrouping.check">
                                                        <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes" ng-keyup="quotaNumberChange(data, groupingCsaModel, csaFlexibility.flxValue,'csaSw')"  ng-class="{'hoverTr-Text':trhovering}">&nbsp;&nbsp;&nbsp;
                                                        <input type="number" class=" text-line" maxlength="3" onkeypress='return validateQty(event);' ng-model="data.per" ng-keyup="quotaPerChange(data.id, groupingCsaModel, csaFlexibility.flxValue, 'csaSw')"  ng-class="{'hoverTr-Text':trhovering}">%
                                                    </td>
                                                    <td ng-hide="csaGrouping.check || data.condditionGroup && csaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true"  ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                    <td ng-hide="csaGrouping.check || data.condditionGroup && csaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true"  ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                    <td ng-if="liveSurveyEditingStep == 'editStep1' && !csaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved"  ng-readonly="true"  ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 text-center">
                                <div class="center-block">
                                        <p><b>Total Remaining</b></p>
                                        <p><b>
                                                <!--<span ng-repeat="option in race track by $index">
                                                    <span ng-show="$last">{{option.totalRem || 0}}</span>
                                                </span>-->
                                                <span ng-if="quotaTotalRemRace == null || quotaTotalRemRace == undefined">
                                                    {{completesNeeded - locationData.achieved | number:0}}
                                                </span>
                                                <span>{{quotaTotalRemRace - locationData.achieved + currLocQuotaFielded  | number:0}}</span>
                                            </b>
                                        </p>
                                </div>
                                <button class="btn btn-primary addQuotas-btn" ng-click="addCSAQuota($event)" ng-disabled="(quotaTotalRemRace - locationData.achieved + currLocQuotaFielded) !=0 || csaAllocationsLessThanFielded" data-dismiss="modal" ng-class="{inactiveButton: !csaGrouping.check}">Apply</button>
                                <button class="btn btn-primary addQuotas-btn" ng-click="addCSAQuota($event); addToNesting('csa', conditionGroupingArray.csa?conditionGroupingArray.csa:selectedCSAs, $event)" ng-disabled="(quotaTotalRemRace - locationData.achieved + currLocQuotaFielded) !=0 || csaAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- CSA model end -->

        <!--MSA quota modal-->
        <div id="msaQuotaModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click="msaQuotaResetModal()"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                                <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                                <h2 class="text-center">Quotas for {{locationViews.msa.name}}:</h2>
                                <p class="text-center" ng-show="isNested('msa')">Applying a layered quota will clear this qualification from your auto-nested quotas, causing them to recalculate.  Please verify the auto-nested quotas modal before selecting suppliers.</p>
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                <span>
                                    <label class="status pull-middle quota-flex-btn">
                                    <input type="checkbox" id="msaSw" ng-model="msaFlexibility.isFlexible" ng-click="setMsaFlex($event, selectedMSAs, msaFlexibility.flxValue)">
                                    <div class="slider round relationr"></div>
                                    </label>&nbsp; &nbsp; by &nbsp; &nbsp; 
                                    <input type="number" class="text-line disabled-state" maxlength="3"  onkeypress='return validateQty(event);' ng-model="msaFlexibility.flxValue" ng-hide ="flexible == false" ng-keyup="quotaPercentageChange(selectedMSAs, msaFlexibility.flxValue); groupingUpdateFleaxibility('msa', groupingMsaModel, msaFlexibility.flxValue)" ng-readonly="!properties.numberOfCompletes || !msaFlexibility.isFlexible" >
                                    <span>%</span>
                                </span>
                            </div>
                            <!-- PD-1402 -->

                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3 text-center" ><br/>
                                <button class="btn btn-primary btn-md grupCondtion submit-btn" type="button" ng-click="msaGrouping.check = !msaGrouping.check" ng-hide="msaGrouping.check">Group Conditions</button>
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="selectedQuotaGrouping('msa',selectedMSAs); msaGrouping.check = !msaGrouping.check" ng-show="msaGrouping.check">Group</button>
                                <!-- &nbsp; &nbsp; &nbsp; &nbsp; -->
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="msaGrouping.check = !msaGrouping.check; removeSelectedQualOnCancel(selectedMSAs,'msa')" ng-show="msaGrouping.check">Cancel</button>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <table class="table" id="rlnform">
                                            <thead>
                                            <tr >
                                                <th></th>
                                                <th ng-hide="msaGrouping.check">{{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                                <th ng-hide="msaGrouping.check">MIN</th>
                                                <th ng-hide="msaGrouping.check">MAX</th>
                                                <th ng-if="liveSurveyEditingStep == 'editStep1' && !msaGrouping.check">FIELDED</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="data in selectedMSAs" ng-if="!isGrouped('msa')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': msaGrouping.check == true? msaGrouping.check : msaGrouping.check = false}" ng-click="data.setGrupActive = (msaGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                    <td >
                                                        <br>
                                                        <label>
                                                            {{data.name}}
                                                        </label>

                                                    </td>
                                                    <td ng-hide="msaGrouping.check">
                                                        <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes" ng-keyup="quotaNumberChange(data, selectedMSAs, msaFlexibility.flxValue,'msaSw')" >&nbsp;&nbsp;&nbsp;
                                                        <input type="number" class=" text-line" maxlength="3" onkeypress='return validateQty(event);' ng-model="data.per" ng-keyup="quotaPerChange(data.id, selectedMSAs, msaFlexibility.flxValue, 'msaSw')">%
                                                    </td>
                                                    <td ng-hide="msaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true">
                                                    </td>
                                                    <td ng-hide="msaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true">
                                                    </td>
                                                    <td ng-if="liveSurveyEditingStep == 'editStep1' && !msaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved"  ng-readonly="true">
                                                    </td>
                                                </tr>
                                                <!-- With Grouping -->
                                                <tr ng-repeat="data in groupingMsaModel" ng-if="isGrouped('msa')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': msaGrouping.check == true? msaGrouping.check : msaGrouping.check = false}" ng-click="data.setGrupActive = (msaGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                    <td ng-hide="data.condditionGroup && msaGrouping.check">
                                                    <br>
                                                    <i class="fa fa-chain-broken" aria-hidden="true" ng-click="ungroupedConditionGrouping( 'msa', data)" ng-show="data.condditionGroup" style="cursor: pointer; font-size: 20px;"></i>
                                                        <label>
                                                            {{data.name}}
                                                        </label>

                                                    </td>
                                                    <td ng-hide="msaGrouping.check || data.condditionGroup && msaGrouping.check">
                                                        <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes" ng-keyup="quotaNumberChange(data, groupingMsaModel, msaFlexibility.flxValue,'msaSw')" ng-class="{'hoverTr-Text':trhovering}" >&nbsp;&nbsp;&nbsp;
                                                        <input type="number" class=" text-line" maxlength="3" onkeypress='return validateQty(event);' ng-model="data.per" ng-keyup="quotaPerChange(data.id, groupingMsaModel, msaFlexibility.flxValue, 'msaSw')" ng-class="{'hoverTr-Text':trhovering}">%
                                                    </td>
                                                    <td ng-hide="msaGrouping.check || data.condditionGroup && msaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                    <td ng-hide="msaGrouping.check || data.condditionGroup && msaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                    <td ng-if="liveSurveyEditingStep == 'editStep1' && !msaGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 text-center">
                                <div class="center-block">
                                        <p><b>Total Remaining</b></p>
                                        <p><b>
                                                <!--<span ng-repeat="option in race track by $index">
                                                    <span ng-show="$last">{{option.totalRem || 0}}</span>
                                                </span>-->
                                                <span ng-if="quotaTotalRemRace == null || quotaTotalRemRace == undefined">
                                                    {{completesNeeded - locationData.achieved | number:0}}
                                                </span>
                                                <span>{{quotaTotalRemRace - locationData.achieved + currLocQuotaFielded| number:0}}</span>
                                            </b>
                                        </p>
                                </div>
                                <button class="btn btn-primary addQuotas-btn" ng-click="addMSAQuota($event)" ng-disabled="(quotaTotalRemRace - locationData.achieved + currLocQuotaFielded) !=0 || msaAllocationsLessThanFielded" data-dismiss="modal" ng-class="{inactiveButton: !msaGrouping.check}">Apply</button>
                                <button class="btn btn-primary addQuotas-btn" ng-click="addMSAQuota($event); addToNesting('msa', conditionGroupingArray.msa?conditionGroupingArray.msa:selectedMSAs, $event)" ng-disabled="(quotaTotalRemRace - locationData.achieved + currLocQuotaFielded) !=0 || msaAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--County quota modal-->
        <div id="countyQuotaModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click="countyQuotaResetModal()"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                                <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                                <h2 class="text-center">Quotas for {{locationViews.county.name}}:</h2>
                                <p class="text-center" ng-show="isNested('county')">Applying a layered quota will clear this qualification from your auto-nested quotas, causing them to recalculate.  Please verify the auto-nested quotas modal before selecting suppliers.</p>
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                <span>
                                    <label class="status pull-middle quota-flex-btn">
                                    <input type="checkbox" id="countySw" ng-model="countyFlexibility.isFlexible" ng-click="setCountyFlex($event, selectedCountys, countyFlexibility.flxValue)">
                                    <div class="slider round relationr"></div>
                                    </label>&nbsp; &nbsp; by &nbsp; &nbsp; 
                                    <input type="number" class="text-line disabled-state" maxlength="3"  onkeypress='return validateQty(event);' ng-model="countyFlexibility.flxValue" ng-hide ="flexible == false" ng-keyup="quotaPercentageChange(selectedCountys, countyFlexibility.flxValue); groupingUpdateFleaxibility('county', groupingCountyModel, countyFlexibility.flxValue)" ng-readonly="!properties.numberOfCompletes || !countyFlexibility.isFlexible" >
                                    <span>%</span>
                                </span>
                            </div>
                            <!-- PD-1402 -->

                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3 text-center" ><br/>
                                <button class="btn btn-primary btn-md grupCondtion submit-btn" type="button" ng-click="countyGrouping.check = !countyGrouping.check" ng-hide="countyGrouping.check">Group Conditions</button>
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="selectedQuotaGrouping('county',selectedCountys); countyGrouping.check = !countyGrouping.check" ng-show="countyGrouping.check">Group</button>
                                <!-- &nbsp; &nbsp; &nbsp; &nbsp; -->
                                <button class="btn btn-primary btn-sm grupCondtion submit-btn" type="button" ng-click="countyGrouping.check = !countyGrouping.check; removeSelectedQualOnCancel(selectedCountys,'county')" ng-show="countyGrouping.check">Cancel</button>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <table class="table" id="rlnform">
                                            <thead>
                                            <tr >
                                                <th></th>
                                                <th ng-hide="countyGrouping.check">{{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                                <th ng-hide="countyGrouping.check">MIN</th>
                                                <th ng-hide="countyGrouping.check">MAX</th>
                                                <th ng-if="liveSurveyEditingStep == 'editStep1' && !countyGrouping.check">FIELDED</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="data in selectedCountys" ng-if="!isGrouped('county')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': countyGrouping.check == true? countyGrouping.check : countyGrouping.check = false}" ng-click="data.setGrupActive = (countyGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                    <td >
                                                        <br>
                                                        <label>
                                                            {{data.name}}
                                                        </label>

                                                    </td>
                                                    <td ng-hide="countyGrouping.check">
                                                        <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes" ng-keyup="quotaNumberChange(data, selectedCountys, countyFlexibility.flxValue,'countySw')" >&nbsp;&nbsp;&nbsp;
                                                        <input type="number" class=" text-line" maxlength="3" onkeypress='return validateQty(event);' ng-model="data.per" ng-keyup="quotaPerChange(data.id, selectedCountys, countyFlexibility.flxValue, 'countySw')">%
                                                    </td>
                                                    <td ng-hide="countyGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true">
                                                    </td>
                                                    <td ng-hide="countyGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true">
                                                    </td>
                                                    <td ng-if="liveSurveyEditingStep == 'editStep1' && !countyGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved"  ng-readonly="true">
                                                    </td>
                                                </tr>
                                                <!-- With Grouping -->
                                                <tr ng-repeat="data in groupingCountyModel" ng-if="isGrouped('county')" ng-class="{'groupingselected': data.selected == true ?data.setGrupActive : data.setGrupActive = false, 'selectGroup': countyGrouping.check == true? countyGrouping.check : countyGrouping.check = false}" ng-click="data.setGrupActive = (countyGrouping.check == true? !data.setGrupActive : data.setGrupActive)" ng-mouseenter="trhovering=true" ng-mouseleave="trhovering=false">
                                                    <td ng-hide="data.condditionGroup && countyGrouping.check">
                                                    <br>
                                                    <i class="fa fa-chain-broken" aria-hidden="true" ng-click="ungroupedConditionGrouping( 'county', data)" ng-show="data.condditionGroup" style="cursor: pointer; font-size: 20px;"></i>
                                                        <label>
                                                            {{data.name}}
                                                        </label>

                                                    </td>
                                                    <td ng-hide="countyGrouping.check || data.condditionGroup && countyGrouping.check">
                                                        <input type="number" class=" text-line" onkeypress='return validateCompletes(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes" ng-keyup="quotaNumberChange(data, groupingCountyModel, countyFlexibility.flxValue,'countySw')" ng-class="{'hoverTr-Text':trhovering}">&nbsp;&nbsp;&nbsp;
                                                        <input type="number" class=" text-line" maxlength="3" onkeypress='return validateQty(event);' ng-model="data.per" ng-keyup="quotaPerChange(data.id, groupingCountyModel, countyFlexibility.flxValue, 'countySw')" ng-class="{'hoverTr-Text':trhovering}">%
                                                    </td>
                                                    <td ng-hide="countyGrouping.check || data.condditionGroup && countyGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                    <td ng-hide="countyGrouping.check || data.condditionGroup && countyGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                    <td ng-if="liveSurveyEditingStep == 'editStep1' && !countyGrouping.check">
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.achieved"  ng-readonly="true" ng-class="{'hoverTr-Text':trhovering}">
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 text-center">
                                <div class="center-block">
                                        <p><b>Total Remaining</b></p>
                                        <p><b>
                                                <!--<span ng-repeat="option in race track by $index">
                                                    <span ng-show="$last">{{option.totalRem || 0}}</span>
                                                </span>-->
                                                <span ng-if="quotaTotalRemRace == null || quotaTotalRemRace == undefined">
                                                    {{completesNeeded - locationData.achieved | number:0}}
                                                </span>
                                                <span>{{quotaTotalRemRace - locationData.achieved + currLocQuotaFielded| number:0}}</span>
                                            </b>
                                        </p>
                                </div>
                                <button class="btn btn-primary addQuotas-btn" ng-click="addCountyQuota()" ng-disabled="(quotaTotalRemRace - locationData.achieved + currLocQuotaFielded) !=0 || countyAllocationsLessThanFielded" data-dismiss="modal" ng-class="{inactiveButton: !countyGrouping.check}">Apply</button>
                                <button class="btn btn-primary addQuotas-btn" ng-click="addCountyQuota(); addToNesting('county', conditionGroupingArray.county?conditionGroupingArray.county:selectedCountys, $event)" ng-disabled="(quotaTotalRemRace - locationData.achieved + currLocQuotaFielded) !=0 || countyAllocationsLessThanFielded" data-dismiss="modal">Apply & Nest</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--zipcode quota modal-->
        <div id="zipcodeQuotaModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click="zipcodeQuotaResetModal(zipcodeQuotaFlg.resetZipQuotaFlg)"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                                <div class="clearfix"></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3" >
                                <h2 class="text-center">Quotas for {{locationViews.zipcode.name}}:</h2>
                            </div>
                            <div class="col-xs-12 col-md-6 col-sm-6 col-md-offset-3 col-sm-offset-3 text-center">
                                <p>FLEXIBLE</p>
                                <span>
                                    <label class="status pull-middle quota-flex-btn">
                                    <input type="checkbox" id="zipcodeSw" ng-model="zipcodeFlexibility.isFlexible">
                                    <div class="slider round relationr"></div>
                                    </label>&nbsp; &nbsp; by &nbsp; &nbsp; 
                                    <input type="number" class="text-line disabled-state" maxlength="3"  onkeypress='return validateQty(event);' ng-model="zipcodeFlexibility.flxValue" ng-hide ="flexible == false" ng-keyup="quotaPercentageChange(selectedZipcodes, zipcodeFlexibility.flxValue)" ng-readonly="!properties.numberOfCompletes || !zipcodeFlexibility.isFlexible" >
                                    <span>%</span>
                                </span>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="table-responsive">
                                        <table class="table" id="rlnform">
                                            <thead>
                                            <tr >
                                                <th></th>
                                                <th>{{properties.clickBalance == 0? 'COMPLETES':'CLICKS'}}</th>
                                                <th>MIN</th>
                                                <th>MAX</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="data in selectedZipcodes track by $index">
                                                    <td >
                                                        <br>
                                                        <label>
                                                            {{data.name}}
                                                        </label>

                                                    </td>
                                                    <td >
                                                        <input type="number" class=" text-line" onkeypress='return validateQty(event);' ng-model="data.number" ng-readonly="!properties.numberOfCompletes" ng-keyup="quotaNumberChange(data, selectedZipcodes, zipcodeFlexibility.flxValue,'zipcodeSw')" >&nbsp;&nbsp;&nbsp;
                                                        <input type="number" class=" text-line" maxlength="2" onkeypress='return validateQty(event);' ng-model="data.per"  ng-keyup="quotaPerChange(data, selectedZipcodes, zipcodeFlexibility.flxValue,'zipcodeSw')">%
                                                    </td>
                                                    <td >
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.minimum"  ng-readonly="true">
                                                    </td>
                                                    <td >
                                                        <input type="number" class="text-line" onkeypress='return validateQty(event);' ng-model="data.maximum"  ng-readonly="true">
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 text-center">
                                <div class="center-block">
                                        <p><b>Total Remaining</b></p>
                                        <p><b>
                                                <!--<span ng-repeat="option in race track by $index">
                                                    <span ng-show="$last">{{option.totalRem || 0}}</span>
                                                </span>-->
                                                <span ng-if="quotaTotalRemRace == null || quotaTotalRemRace == undefined">
                                                    {{completesNeeded | number:0}}
                                                </span>
                                                <span>{{quotaTotalRemRace | number:0}}</span>
                                            </b>
                                        </p>
                                </div>
                                <button class="btn btn-primary addQuotas-btn" ng-click="addZipcodeQuota()" ng-disabled="quotaTotalRemRace !=0 || zipcodeAllocationsLessThanFielded" data-dismiss="modal">Apply</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--view uploaded zipcodes model-->
        <div id="viewZipcodes" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                                <div class="clearfix"></div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                            <h4>Latest uploads</h4>
                            <p id="view-zipcodes"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--nesting modal-->
        <div id="nestingModal" class="modal animated bounceIn quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-if="properties.numberOfCompletes">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary" data-dismiss="modal" ng-click="clearUnappliedNesting($event)"><i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span></button>
                            <div class="clearfix"></div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2 col-md-offset-2" ng-if="nestedQuotasUiObj.length > completesNeeded">
                            <div class="red-warning-box">
                                <span>There are more quotas than completes available.  Some nested quotas have 0 quantity available.  This may cause unexpected behavior - please revise nested quotas if this warning is unexpected.</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-6 col-md-6 col-md-offset-3  col-sm-offset-3">
                                <h2 class="text-center">Nesting</h2>
                                <p class="text-center">To auto-nest a qualification condition, first add a quantity to the desired condition in the appropriate modal.</p>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 col-md-8 col-md-offset-2">
                            <div class="panel">
                                <div class="panel-body">
                                    <div class="nesting-quotas-button text-center">
                                        <button type="button" key-name="gender" class="btn btn-default" ng-if="gndrQuotaFlag.hasGndrFlag || isNested('gender')" ng-class="{active:isNested('gender')}" ng-click="activateNesting('gender', genderInfo, $event)">Gender</button>
                                        <button type="button" key-name="age" class="btn btn-default" ng-if="ageQuotaFlag.hasAgeFlag || isNested('age')" ng-class="{active:isNested('age')}" ng-click="activateNesting('age', ageTempArr, $event)">Age</button>
                                        <button type="button" key-name="houseHoldIncome" class="btn btn-default" ng-if="incomeQuotaFlag.hasIncomeFlag || isNested('houseHoldIncome')" ng-class="{active:isNested('houseHoldIncome')}" ng-click="activateNesting('houseHoldIncome', incomeTempArr, $event)">Income</button>
                                        <button type="button" key-name="race" class="btn btn-default" ng-if="raceQuotaFlag.hasRaceFlag || isNested('race')" ng-class="{active:isNested('race')}" ng-click="activateNesting('race', conditionGroupingArray.race?conditionGroupingArray.race:race, $event)">Race</button>
                                        <button type="button" key-name="relationships" class="btn btn-default" ng-if="rlnQuotaFlag.hasRlnFlag || isNested('relationships')" ng-class="{active:isNested('relationships')}" ng-click="activateNesting('relationships', conditionGroupingArray.relationships?conditionGroupingArray.relationships:relation, $event)">Relationship</button>
                                        <button type="button" key-name="children" class="btn btn-default" ng-if="childQuotaFlag.hasChldFlag || isNested('children')" ng-class="{active:isNested('children')}" ng-click="activateNesting('children', chldTempArr, $event)">Children</button>
                                        <button type="button" key-name="employments" class="btn btn-default" ng-if="empQuotaFlag.hasEmpFlag || isNested('employments')" ng-class="{active:isNested('employments')}" ng-click="activateNesting('employments', conditionGroupingArray.employments?conditionGroupingArray.employments:employement, $event)">Employment</button>
                                        <button type="button" key-name="educations" class="btn btn-default" ng-if="eduQuotaFlag.hasEduFlag || isNested('educations')" ng-class="{active:isNested('educations')}" ng-click="activateNesting('educations', conditionGroupingArray.educations?conditionGroupingArray.educations:education, $event)">Education</button>
                                        <!-- <button type="button" key-name="device" class="btn btn-default" ng-show="dvcQuotaFlag.hasDeviceFlag || isNested('device')" ng-click="activateNesting('device', deviceInfo, $event)">Device</button> -->
                                        <button type="button" key-name="regions" class="btn btn-default" ng-if="regQuotaFlag.hasRegionFlag || isNested('regions')" ng-class="{active:isNested('regions')}" ng-click="activateNesting('regions', conditionGroupingArray.regions?conditionGroupingArray.regions:region, $event)">Region</button>
                                        <button type="button" key-name="divisions" class="btn btn-default" ng-if="dvsnQuotaFlag.hasDivisionFlag || isNested('divisions')" ng-class="{active:isNested('divisions')}" ng-click="activateNesting('divisions', conditionGroupingArray.divisions?conditionGroupingArray.divisions:division, $event)">Division</button>
                                        <button type="button" key-name="states" class="btn btn-default" ng-if="hasStateFlag || isNested('states')" ng-class="{active:isNested('states')}" ng-click="activateNesting('states', conditionGroupingArray.states?conditionGroupingArray.states:selectedStates, $event, null)">{{locationViews.state.name}}</button>
                                        <button type="button" key-name="csa" class="btn btn-default" ng-if="hasCSAFlag || isNested('csa')" ng-class="{active:isNested('csa')}" ng-click="activateNesting('csa', conditionGroupingArray.csa?conditionGroupingArray.csa:selectedCSAs, $event)">{{locationViews.csa.name}}</button>
                                        <button type="button" key-name="msa" class="btn btn-default" ng-if="hasMSAFlag || isNested('msa')" ng-class="{active:isNested('msa')}" ng-click="activateNesting('msa', conditionGroupingArray.msa?conditionGroupingArray.msa:selectedMSAs, $event)">{{locationViews.msa.name}}</button>
                                        <button type="button" key-name="dma" class="btn btn-default" ng-if="hasDMAFlag || isNested('dma')" ng-class="{active:isNested('dma')}" ng-click="activateNesting('dma', conditionGroupingArray.dma?conditionGroupingArray.dma:selectedDMAs, $event)">{{locationViews.dma.name}}</button>
                                        <button type="button" key-name="county" class="btn btn-default" ng-if="hasCountyFlag || isNested('county')" ng-class="{active:isNested('county')}" ng-click="activateNesting('county', conditionGroupingArray.county?conditionGroupingArray.county:selectedCountys, $event)">{{locationViews.county.name}}</button>
                                        <button type="button" key-name="zipcodes" class="btn btn-default" ng-if="zipcodeQuotaFlg.editZipcodeFlag || isNested('zipcodes')" ng-class="{active:isNested('zipcodes')}" ng-click="activateNesting('zipcodes', conditionGroupingArray.zip?conditionGroupingArray.zip:selectedZipcodes, $event)">{{locationViews.zipcode.name}}</button>
                                        <span ng-repeat="item in tempAdvArray">
                                            <button type="button" key-name="item.question_description" class="btn btn-default" ng-if="item.hasQuota || isNested(item.question_description)" ng-class="{active:isNested(item.question_description)}" ng-click="activateNesting(item.question_description, item.selected[item.qualification_id[0]].answer_data, $event, item.question_type)">{{item.question_description}}</button>
                                        </span>
                                      

                                    </div>
                                    <div class="table-responsive">
                                        <table class="table" id="nestingform">
                                            <thead>
                                                <th colspan="nestingQuotasArr.length">Nested Quota Details</th>
                                                <th colspan="2" class="text-center">Allocation</th>
                                                <th colspan="2" class="text-center">Flexibility</th>
                                                <th class="text-center">Fielded</th>
                                            </thead>
                                            <thead>
                                                <th>
                                                    <span ng-repeat="name in nestingQuotasArr track by $index">{{name}}</span>
                                                </th>
                                                <!--<th ng-show="hasLocationFlag">LOCATION</th>-->
                                                <th class="text-center">#</th>
                                                <th class="text-center">%</th>
                                                <th class="text-center">MIN</th>
                                                <th class="text-center">MAX</th>
                                                <th>&nbsp;</th>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="data in nestedQuotasUiObj track by $index">
                                                    <td class="td-th-class">
                                                        <span ng-repeat="nested in data.combinedKey track by $index">{{nested}}</span>
                                                    </td>
                                                    <td class="td-th-class text-center" ng-bind="data.number"></td>
                                                    <td class="td-th-class text-center" ng-bind="data.percentage"></td>
                                                    <td class="td-th-class text-center" ng-bind="data.minimum"></td>
                                                    <td class="td-th-class text-center" ng-bind="data.maximum"></td>
                                                    <td class="td-th-class text-center" ng-bind="data.fielded"></td>
                                                </tr>
                                            </tbody>
                                        </table>  
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-md-8 col-md-offset-2 text-center" >
                                <button class="btn btn-primary addQuotas-btn pull-right" ng-click="applyNesting()" ng-disabled="nestingQuotasArr.length <= 0" data-dismiss="modal">Apply Nesting </button>
                                <button class="btn btn-primary addQuotas-btn pull-left" ng-click="clearNesting()">Clear Nesting </button>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                    </div>
                </div>
              </div>
        </div>
    
        <!-- age quotas modal -->
        <div class="modal fade warning-modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content1 panel-warning1">
                        <!-- <div class="modal-header panel-heading1">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        </div> -->
                        <div class="modal-body1 text-center">
                            <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
                            <p>Are you sure you want to delete the age quotas?</p>
                        </div>
                        <div class="modal-footer1">
                            <button type="button" class="btn btn-default no-button pull-left" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary yes-button pull-right" data-dismiss="modal" ng-click="ageSltBoxVal()" >Delete</button>
                        </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal-fade -->

        <!-- modal to confirm change in country -->
        <a href="" id="cntryModal" style="display:none !important" data-toggle="modal" data-target="#countryModal">&nbsp;&nbsp;clr</a>
        <div class="modal fade warning-modal" id="countryModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content1 panel-warning1">
                        <div class="modal-body1 text-center">
                            <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
                            <p>Changing country will clear all qualifications set for this survey. Do you really want to change Country?</p>
                            <!-- <p><input type="checkbox" name="">&nbsp;Don't warn me again</p> -->
                        </div>
                        <div class="modal-footer1">
                            <button type="button" class="btn btn-default no-button pull-left" data-dismiss="modal" ng-click="cancelCountrySelected()">Cancel</button>
                            <button type="button" class="btn btn-primary yes-button pull-right" data-dismiss="modal" ng-click="setCountrySelected()">OK</button>
                        </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal-fade -->

        <!-- clear location confirm box -->
        <div class="modal fade warning-modal" id="alreadySetLocationModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content1 panel-warning1">
                        <div class="modal-body1 text-center">
                            <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
                            <p>Are you sure you want to clear all location quotas & qualifications?</p>
                            <!-- <p><input type="checkbox" name="">&nbsp;Don't warn me again</p> -->
                        </div>
                        <div class="modal-footer1">
                            <button type="button" class="btn btn-default no-button pull-left" data-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-primary yes-button pull-right" data-dismiss="modal" ng-click="clearAllLocation($event)">OK</button>
                        </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal-fade -->

        <!-- already set for another location  confirm box -->
        <div class="modal fade warning-modal" id="clrLocationModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content1 panel-warning1">
                        <div class="modal-body1 text-center">
                            <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
                            <p>Setting this location criteria will clear location qualifications in other categories.  Select OK to continue</p>
                            <!-- <p><input type="checkbox" name="">&nbsp;Don't warn me again</p> -->
                        </div>
                        <div class="modal-footer1">
                            <button type="button" class="btn btn-default no-button pull-left" data-dismiss="modal" ng-click="cancelClearLocation()">Cancel</button>
                            <button id="clickOkModel" type="button" class="btn btn-primary yes-button pull-right" data-dismiss="modal" ng-click="clearAllLocation($event)">OK</button>
                        </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal-fade -->

        <!-- censusResion quotas modal -->
        <div class="modal fade warning-modal" id="resionModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content1 panel-warning1">
                        <div class="modal-body1 text-center">
                            <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
                            <p>Are you sure you want to delete the region quotas?</p>p
                        </div>
                        <div class="modal-footer1">
                            <button type="button" class="btn btn-default no-button pull-left" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary yes-button pull-right" data-dismiss="modal" ng-click="clearCensusRegion(region)">Clear</button>
                        </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal-fade -->

        <!-- censusDivision quotas modal -->
        <div class="modal fade warning-modal" id="divisionModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content1 panel-warning1">
                        <div class="modal-body1 text-center">
                            <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
                            <p>Are you sure you want to delete the division quotas?</p>
                        </div>
                        <div class="modal-footer1">
                            <button type="button" class="btn btn-default no-button pull-left" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary yes-button pull-right" data-dismiss="modal" ng-click="clearCensusDivision(division)">Clear</button>
                        </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal-fade -->

        <!-- state  quotas reset alert modal -->
        <div class="modal fade warning-modal" id="stateModalResetAlert" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content1 panel-warning1">
                        <div class="modal-body1 text-center">
                            <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
                            <p>Are you sure you want to delete the state quotas?</p>
                        </div>
                        <div class="modal-footer1">
                            <button type="button" class="btn btn-default no-button pull-left" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary yes-button pull-right" data-dismiss="modal" ng-click="resetStateQuotas = true; stateQuotaResetModal()">Clear</button>
                        </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal-fade -->

        <!-- DMA  quotas reset alert modal -->
        <div class="modal fade warning-modal" id="dmaModalResetAlert" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content1 panel-warning1">
                        <div class="modal-body1 text-center">
                            <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
                            <p>Are you sure you want to delete the DMA quotas?</p>
                        </div>
                        <div class="modal-footer1">
                            <button type="button" class="btn btn-default no-button pull-left" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary yes-button pull-right" data-dismiss="modal" ng-click="resetDMAQuotas = true; dmaQuotaResetModal()">Clear</button>
                        </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal-fade -->

        <!-- CSA  quotas reset alert modal -->
        <div class="modal fade warning-modal" id="csaModalResetAlert" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content1 panel-warning1">
                        <div class="modal-body1 text-center">
                            <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
                            <p>Are you sure you want to delete the CSA of quotas?</p>
                        </div>
                        <div class="modal-footer1">
                            <button type="button" class="btn btn-default no-button pull-left" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary yes-button pull-right" data-dismiss="modal" ng-click="resetCSAQuotas = true; csaQuotaResetModal()">Clear</button>
                        </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal-fade -->

        <!-- MSA  quotas reset alert modal  -->
        <div class="modal fade warning-modal" id="msaModalResetAlert" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content1 panel-warning1">
                        <div class="modal-body1 text-center">
                            <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
                            <p>Are you sure you want to delete the MSA quotas?</p>
                        </div>
                        <div class="modal-footer1">
                            <button type="button" class="btn btn-default no-button pull-left" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary yes-button pull-right" data-dismiss="modal" ng-click="resetMSAQuotas = true; msaQuotaResetModal()">Clear</button>
                        </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal-fade -->

        <!-- County  quotas reset alert modal  -->
        <div class="modal fade warning-modal" id="countyModalResetAlert" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content1 panel-warning1">
                        <div class="modal-body1 text-center">
                            <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
                            <p>Are you sure you want to delete the county quotas?</p>
                        </div>
                        <div class="modal-footer1">
                            <button type="button" class="btn btn-default no-button pull-left" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary yes-button pull-right" data-dismiss="modal" ng-click="resetCountyQuotas = true; countyQuotaResetModal()">Clear</button>
                        </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal-fade -->

        <!-- zipcodes  quotas reset alert modal  -->
        <div class="modal fade" id="zipcodeModalResetAlert" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content1 panel-warning1">
                        <div class="modal-body1 text-center">
                            <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
                            <p>Are you sure you want to clear all fill in number of quotas?</p>
                        </div>
                        <div class="modal-footer1">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="resetZipcodeQuotas = true; zipcodeQuotaResetModal('true')">Clear</button>
                        </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal-fade -->

        <!-- income quotas modal -->
        <div class="modal fade warning-modal" id="myModalincome" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content1 panel-warning1">
                    <!-- <div class="modal-header panel-heading1">
                     <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    </div> -->
                    <div class="modal-body1 text-center">
                        <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
                        <p>Are you sure you want to delete the income quotas?</p>
                        <!-- <p><input type="checkbox" name="">Don't warn me again</p> -->
                    </div>
                    <div class="modal-footer1">
                        <button type="button" class="btn btn-default no-button pull-left" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary yes-button pull-right" data-dismiss="modal" ng-click="incomeSltBoxVal()" >Delete</button>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal-fade -->

        <!-- Direct Edit Value Reset When Live Edit -->
        <div class="modal fade warning-modal" id="directEditReset" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content1 panel-warning1">
                    <!-- <div class="modal-header panel-heading1">
                     <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    </div> -->
                    <div class="modal-body1 text-center">
                        <i class="fa fa-exclamation-circle" aria-hidden="true"></i>
                        <p>Edited Current Target amounts may be affected by your changes.  Would you like to continue?</p>
                    </div>
                    <div class="modal-footer1">
                        <button type="button" class="btn btn-default no-button pull-left" data-dismiss="modal">No</button>
                        <button type="button" class="btn btn-primary yes-button pull-right" data-dismiss="modal" ng-click="saveSurvey('goToManageSurvey')">Yes</button>
                        <div class="clearfix"></div>
                    </div>
                </div><!-- /.modal-content -->
            </div><!-- /.modal-dialog -->
        </div><!-- /.modal-fade -->

        <!--********* Advance Modal*************-->
        <div id="advanceTargetingModal" class="modal fade quotas-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content1">
                    <div class="modal-body1">
                        <div class="feasibility-header">
                            <button id="ps-modal-close" class="btn btn-secondary advclose" data-dismiss="modal" ng-click="clearAdvModal()">
                                <i class="fa fa-times" aria-hidden="true"></i>
                                <span class="key_label">esc</span>
                            </button>
                            <div class="clearfix"></div>
                        </div>
                        <div class="adv-tar-inner">
                            <ng-advance-autocomplete id="adv-question" items="selectQuestDes" prompt="Start typing ..." model="questionText" selected-question ="questionDetail" answer-option="myOptions" selected-options ="selectedOptions" choosed-question="tempAdvArray" lock-question="lockQuestion" ng-class="{lockedQuestion:lockQuestion}" language-code="properties.languageCode" country-code="properties.countryCode" range-ques-option="rangeQuesOption" default-range="advRange.condition" />
                            <p ng-if="questionDetail.stem1" class="text-center">{{questionDetail.stem1_ui}}</p>
                            <selectize config="optionConfig" options="myOptions" ng-model="selectedOptions" ng-if="questionDetail && (questionDetail.question_type == 'multipunch' || questionDetail.question_type == 'singlepunch')"></selectize>
                            <div class="adv-range text-center" ng-if="questionDetail && questionDetail.question_type == 'range'">
                                <select ng-model="advRange.condition" ng-change="calculateAdvRange()">
                                    <option ng-value="rangeQuesOption.first">{{rangeQuesOption.first}}</option>
                                    <option ng-value="rangeQuesOption.second">{{rangeQuesOption.second}}</option>
                                </select>
                                <input type="number" class="form-control border-less-input" ng-model="advRange.orig_value" ng-change="calculateAdvRange()" />
                            </div>
                            <p id="days_row" class="text-center animationIf" ng-if="questionDetail.stem2 != ''"></p>
                            <button class="btn btn-default btn-lg submit-btn" ng-click="saveAdvTarget(questionDetail)">Apply Targeting</button>
                            <!-- ( ( questionDetail.question_type == 'range' && (advRange.orig_value == '' || advRange.orig_value == undefined || angular.element( document.querySelector( '#advDays' ) ).val() != '') ) || (questionDetail.question_type == 'multipunch' && (selectedOptions.length == 0 || angular.element( document.querySelector( '#advDays' ) ).val() == '') ) ) -->
                        </div>
                    </div>
                </div>
              </div>
        </div>

        <!-- loader -->
        <div class="overlay-div" ng-show="loader.show">
            <div id="loader-wrapper">
                <div id="loader"><span></span></div>
            </div>
        </div>
    </div>
</div><br>


<script>

    $(document.body).on( 'click', '.dropdown-menu li', function( event ) {
            var selText = $(this).text();
            $(this).parents('.form-group').find('.dropdown-toggle').html(selText);
    });
    function validateQty(event) {
        var key = window.event ? event.keyCode : event.which;

        if (event.keyCode == 8 || event.keyCode == 46
                || event.keyCode == 37 || event.keyCode == 39) {
            return true;
        }
        else if ( key < 48 || key > 57 ) {
            return false;
        }
        else return true;
    };

   $(document).ready(function(){
       $('.survey-radio-inline').on('click','input[type=radio]',function() {
           $(this).closest('.survey-radio-inline').find('.radio-inline, .radio').removeClass('checked');
           $(this).closest('.radio-inline, .radio').addClass('checked');
       });

   });

    $('.dropdown-menu input, .dropdown-menu .search-control').click(function(e) {
        e.stopPropagation();
    });
    
    jQuery(document).ready(function() {
        //======= get dropdown value =========
        jQuery('.survey-form .dropdown-menu li a').click(function(e){
            e.preventDefault();
        });
        
        //====== Select Dropdown Value ======   
        jQuery('.dropdown-menu li a').click(function(e){
            e.preventDefault();
            var value = jQuery(this).text();
            jQuery(this).parents('.dropdown').find('.btn.survey-style').text(value);
        }); 

          //======= Active tabs ========
          jQuery('.set-location .nav.nav-tabs > li').click(function(e){
            jQuery(this).siblings().removeClass('active');
            jQuery(this).addClass('active');
          });
          //========= tabs functionality =========

          jQuery('.tabs .nav-tabs a').on('click', function(e){
            var currentAttrValue = jQuery(this).attr('href');
            // Show/Hide Tabs
            jQuery('.tabs ' +currentAttrValue).show().siblings().hide();
            // Change/remove current tab to active
            jQuery(this).parent('li').addClass('active').siblings().removeClass('active');
          });

          $('.tabs .nav-tabs a, .custom-tabs li a').bind('click',function(evt){
            evt.preventDefault();
          });

          //=========== include/exclude wwitch ===============

          jQuery('.cmn-toggle.cmn-toggle-round').on('click', function(){
            jQuery(this).siblings('span').toggleClass('selected');
          });

          jQuery('.survey-state ul li > a').on('click', function(e){
            e.preventDefault();
            jQuery(this).parent('li').remove();
          });

          //================ tooltip csa ===============
          jQuery('.download-csv >a:last-of-type').hover(function(){
            jQuery('.template, .triangle').toggleClass('show');
          });
    });


    function closeIt(){
        $('body').removeClass('modal-open');
        $('.modal-backdrop').remove();
    }

    $('.dropdown').keydown(function(e){
        if(e.which == 9){ // tab
            e.preventDefault();
            $(this).parent().find('.dropdown-toggle').click();
            $(this).parent().find('.dropdown-menu a:first').focus();
        }
    });

    /*===== Currency Format
    ===========*/
    function format(input){
        var nStr = input.value + '';
        nStr = nStr.replace( /\,/g, "");
        var x = nStr.split( '.' );
        var x1 = x[0];
        var x2 = x.length > 1 ? '.' + x[1] : '';
        var rgx = /(\d+)(\d{3})/;
        while ( rgx.test(x1) ) {
            x1 = x1.replace( rgx, '$1' + ',' + '$2' );
        }
        input.value = x1 + x2;
    }


    /*==== validate freactional value on create survey
    */
    function validateCompletes(event){ 
        var key = window.event ? event.keyCode : event.which;
        if (event.keyCode == 8 
            || event.keyCode == 37 || event.keyCode == 39) {
            return true;
        }else if ( event.keyCode == 46 || key < 48 || key > 57) {
            return false;
        }else {
            return true;
        }
    };
</script>
